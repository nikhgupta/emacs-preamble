{"name":"Emacs-preamble","tagline":"Emacs' Preamble","body":"<div id=\"table-of-contents\">\r\n<h2>Table of Contents</h2>\r\n<div id=\"text-table-of-contents\">\r\n<ul>\r\n<li><a href=\"#sec-1\">1. Emacs' Preamble</a>\r\n<ul>\r\n<li><a href=\"#sec-1-1\">1.1. Motivation</a></li>\r\n<li><a href=\"#sec-1-2\">1.2. Philosophy</a></li>\r\n<li><a href=\"#sec-1-3\">1.3. Website</a></li>\r\n<li><a href=\"#sec-1-4\">1.4. Credits</a></li>\r\n<li><a href=\"#sec-1-5\">1.5. License</a></li>\r\n<li><a href=\"#sec-1-6\">1.6. Requirements</a></li>\r\n<li><a href=\"#sec-1-7\">1.7. Installation</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-2\">2. Basic Configuration</a>\r\n<ul>\r\n<li><a href=\"#sec-2-1\">2.1. Initialization</a></li>\r\n<li><a href=\"#sec-2-2\">2.2. Commentary</a></li>\r\n<li><a href=\"#sec-2-3\">2.3. Compatibility</a></li>\r\n<li><a href=\"#sec-2-4\">2.4. Debugging</a></li>\r\n<li><a href=\"#sec-2-5\">2.5. Avoid Screen-flickering</a></li>\r\n<li><a href=\"#sec-2-6\">2.6. Custom Routines</a></li>\r\n<li><a href=\"#sec-2-7\">2.7. General Behavior</a></li>\r\n<li><a href=\"#sec-2-8\">2.8. General Appearance</a></li>\r\n<li><a href=\"#sec-2-9\">2.9. Editor Behaviour</a></li>\r\n<li><a href=\"#sec-2-10\">2.10. Always Run Server</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-3\">3. Packages</a>\r\n<ul>\r\n<li><a href=\"#sec-3-1\">3.1. Repositories</a></li>\r\n<li><a href=\"#sec-3-2\">3.2. On Demand Installation</a></li>\r\n<li><a href=\"#sec-3-3\">3.3. Trivial Packages</a></li>\r\n<li><a href=\"#sec-3-4\">3.4. File-type Specific Packages</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-4\">4. User Interface</a>\r\n<ul>\r\n<li><a href=\"#sec-4-1\">4.1. Themes</a></li>\r\n<li><a href=\"#sec-4-2\">4.2. Frame and Windows</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-5\">5. Basic Modules</a>\r\n<ul>\r\n<li><a href=\"#sec-5-1\">5.1. auto-complete</a></li>\r\n<li><a href=\"#sec-5-2\">5.2. diminish</a></li>\r\n<li><a href=\"#sec-5-3\">5.3. dired</a></li>\r\n<li><a href=\"#sec-5-4\">5.4. fci-mode</a></li>\r\n<li><a href=\"#sec-5-5\">5.5. flycheck</a></li>\r\n<li><a href=\"#sec-5-6\">5.6. hippie-expand</a></li>\r\n<li><a href=\"#sec-5-7\">5.7. ibuffer</a></li>\r\n<li><a href=\"#sec-5-8\">5.8. ido-mode</a></li>\r\n<li><a href=\"#sec-5-9\">5.9. isearch</a></li>\r\n<li><a href=\"#sec-5-10\">5.10. mmm-mode</a></li>\r\n<li><a href=\"#sec-5-11\">5.11. recentf</a></li>\r\n<li><a href=\"#sec-5-12\">5.12. silver-searcher</a></li>\r\n<li><a href=\"#sec-5-13\">5.13. tramp</a></li>\r\n<li><a href=\"#sec-5-14\">5.14. undo-tree</a></li>\r\n<li><a href=\"#sec-5-15\">5.15. uniquify</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-6\">6. Editing</a>\r\n<ul>\r\n<li><a href=\"#sec-6-1\">6.1. Packages</a></li>\r\n<li><a href=\"#sec-6-2\">6.2. Configurations</a></li>\r\n<li><a href=\"#sec-6-3\">6.3. ParEdit</a></li>\r\n<li><a href=\"#sec-6-4\">6.4. Spell Check</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-7\">7. Org Mode</a>\r\n<ul>\r\n<li><a href=\"#sec-7-1\">7.1. General Configuration</a></li>\r\n<li><a href=\"#sec-7-2\">7.2. Agenda Setup</a></li>\r\n<li><a href=\"#sec-7-3\">7.3. OSX Integration</a></li>\r\n<li><a href=\"#sec-7-4\">7.4. Refile / Archives</a></li>\r\n<li><a href=\"#sec-7-5\">7.5. TODO Keywords / Tagging</a></li>\r\n<li><a href=\"#sec-7-6\">7.6. Clocking</a></li>\r\n<li><a href=\"#sec-7-7\">7.7. Captures</a></li>\r\n<li><a href=\"#sec-7-8\">7.8. Encryption</a></li>\r\n<li><a href=\"#sec-7-9\">7.9. Key Bindings</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-8\">8. Programming</a>\r\n<ul>\r\n<li><a href=\"#sec-8-1\">8.1. Ruby Group</a></li>\r\n<li><a href=\"#sec-8-2\">8.2. PHP Group</a></li>\r\n<li><a href=\"#sec-8-3\">8.3. Javascript Group</a></li>\r\n<li><a href=\"#sec-8-4\">8.4. Text Group</a></li>\r\n<li><a href=\"#sec-8-5\">8.5. XML Group</a></li>\r\n<li><a href=\"#sec-8-6\">8.6. Design Group</a></li>\r\n<li><a href=\"#sec-8-7\">8.7. Lisp Group</a></li>\r\n<li><a href=\"#sec-8-8\">8.8. Other Languages</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-9\">9. Session Management</a>\r\n<ul>\r\n<li><a href=\"#sec-9-1\">9.1. Configuration</a></li>\r\n<li><a href=\"#sec-9-2\">9.2. Restore Session Variables</a></li>\r\n<li><a href=\"#sec-9-3\">9.3. Restore Frame</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-10\">10. Version Management</a>\r\n<ul>\r\n<li><a href=\"#sec-10-1\">10.1. Related Modules</a></li>\r\n<li><a href=\"#sec-10-2\">10.2. Magit Configuration</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-11\">11. OSX Specific Configuration</a></li>\r\n<li><a href=\"#sec-12\">12. Key Bindings</a>\r\n<ul>\r\n<li><a href=\"#sec-12-1\">12.1. <span class=\"todo FIXME\">FIXME</span> Global Mappings</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-13\">13. Updates</a>\r\n<ul>\r\n<li><a href=\"#sec-13-1\">13.1. TODO there should be a scheduler to automatically check for updates.</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-14\">14. Epilogue</a></li>\r\n<li><a href=\"#sec-15\">15. Other Tasks</a>\r\n<ul>\r\n<li><a href=\"#sec-15-1\">15.1. BUG pressing C-z will still minimize the window when using Emacs' GUI</a></li>\r\n<li><a href=\"#sec-15-2\">15.2. BUG HTMLize and FCI-mode does not work together.</a></li>\r\n<li><a href=\"#sec-15-3\">15.3. DONE set a different <code>fill-column</code> particularly for this org file</a></li>\r\n<li><a href=\"#sec-15-4\">15.4. DONE remove the following settings, when configuration is complete.</a></li>\r\n<li><a href=\"#sec-15-5\">15.5. DONE show total load time when Emacs has initialized in the mini-buffer</a></li>\r\n<li><a href=\"#sec-15-6\">15.6. DONE tangling should only be done when changes are detected</a></li>\r\n<li><a href=\"#sec-15-7\">15.7. DONE magit should be colorful</a></li>\r\n<li><a href=\"#sec-15-8\">15.8. TODO whitespace related settings should only take place in prog-mode</a></li>\r\n<li><a href=\"#sec-15-9\">15.9. TODO Org Block: Only colorize till fill column indicator</a></li>\r\n<li><a href=\"#sec-15-10\">15.10. TODO Quick Scratch for current mode</a></li>\r\n<li><a href=\"#sec-15-11\">15.11. TODO mousewheel should be able to move up and down in buffer - cursor being at same place.</a></li>\r\n<li><a href=\"#sec-15-12\">15.12. DONE Delete trailing whitespace on save</a></li>\r\n<li><a href=\"#sec-15-13\">15.13. TODO ^L to &lt;hl&gt;: &lt;hl&gt; spans more than one line</a></li>\r\n<li><a href=\"#sec-15-14\">15.14. TODO fci-mode should take care of blocks, as well.</a></li>\r\n<li><a href=\"#sec-15-15\">15.15. TODO fci-mode does not work in GUI mode</a></li>\r\n<li><a href=\"#sec-15-16\">15.16. TODO visual bell should appear inside mini-buffer</a></li>\r\n<li><a href=\"#sec-15-17\">15.17. TODO <b>Messages</b> buffer should use <code>org-mode</code></a></li>\r\n<li><a href=\"#sec-15-18\">15.18. TODO Distraction free mode?</a></li>\r\n<li><a href=\"#sec-15-19\">15.19. TODO jump to the location of last edit</a></li>\r\n<li><a href=\"#sec-15-20\">15.20. DONE org-mode export as html should syntax-highlight the code natively</a></li>\r\n<li><a href=\"#sec-15-21\">15.21. TODO ensure that emacs is started maximized</a></li>\r\n<li><a href=\"#sec-15-22\">15.22. DONE activating <code>mmm-mode</code> gives error</a></li>\r\n<li><a href=\"#sec-15-23\">15.23. TODO Implement some <code>mmm</code> modes by taking help from samples.</a></li>\r\n<li><a href=\"#sec-15-24\">15.24. CANCELLED Magit should quit itself when changes were pushed?</a></li>\r\n</ul>\r\n</li>\r\n<li><a href=\"#sec-16\">16. Emacs Options</a></li>\r\n</ul>\r\n</div>\r\n</div>\r\n\r\n\r\n# Emacs' Preamble<a id=\"sec-1\" name=\"sec-1\"></a>\r\n\r\n## Motivation<a id=\"sec-1-1\" name=\"sec-1-1\"></a>\r\n\r\nI have been a long-time [vim](http://www.vim.org) user, and started using [Emacs](http://gnu.org/s/emacs) because of the awesome [org-mode](http://orgmode.org) feature,\r\nit provides. Definitely, I have been impressed. People were right *for once*! I have, only, been\r\nusing Emacs for a couple of weeks, and I'm already in love with it, primarily, because:\r\n\r\n-   it has the neatest organizer in this world: the `org-mode`.\r\n-   it uses `elisp` to pragmatically change itself.\r\n\r\nSo, soon I was dwelling inside the dark world of getting my new editor resonate with myself. I tried\r\nseveral starter packages, *viz.*:\r\n\r\n-   [Emacs Live](http://github.com/overtone/emacs-live)\r\n-   [Emacs Prelude](http://github.com/bbatsov/prelude)\r\n-   [Emacs Starter Kit](http://eschulte.github.io/emacs24-starter-kit/)\r\n-   [@purcell's Emacs configuration](http://github.com/purcell/emacs.d)\r\n\r\nAnd, I really enjoyed my couple of days of flirting with these kits, and they were really nice, but\r\nsomehow, they did not represent me.\r\n\r\n> My editor felt like someone else' baby in my hands - it was adorable, and cute and what not, but it\r\n> wasn't mine. :)\r\n\r\nSo, I started working on my own take at Emacs' configuration, finally, and proudly, called it:\r\n[Emacs' Preamble](http://github.com/nikhgupta/preamble) - made it, remade it, and remade it again and again and each time, I switched the\r\nway it represented itself. I had already seen [Sacha Chua's Emacs Configuration](http://dl.dropboxusercontent.com/u/3968124/sacha-emacs.html), and wanted my own to\r\nbe based upon [org-babel](http://orgmode.org/worg/org-contrib/babel/), as well.\r\n\r\n## Philosophy<a id=\"sec-1-2\" name=\"sec-1-2\"></a>\r\n\r\n`org-babel` is *awesome*. It empowers Org-mode to execute source code within Org-mode documents. It\r\nis built upon the principles of [Literate Programming](http://en.wikipedia.org/wiki/Literate_programming), and can embed multiple languages within a\r\nsingle document.\r\n\r\nExtending upon the same, the current Org-mode file documents my configuration for Emacs, sanely\r\nnamed as **Emacs' Preamble**. The source code inside `elisp` source blocks is *tangled* by Babel, and\r\nis then loaded as configuration via `org-babel-load-file` function. We make sure that only\r\n`emacs-lisp` based code is tangled by `org-mode`, as follows:\r\n\r\n    (org-babel-tangle-file \"preamble.org\" \"output/preamble.el\" \"emacs-lisp\")\r\n\r\n## Website<a id=\"sec-1-3\" name=\"sec-1-3\"></a>\r\n\r\n**Emacs' Preamble** exists in a [repository](http://github.com/nikhgupta/preamble) on [Github](http://github.com), and can be read there, as Github easily converts\r\n`org-mode` documents in a readable format. However, I have created a [dedicated section](http://nikhgupta.com/preamble) on my\r\nwebsite, where the documentation (i.e. this file, itself) can be read in a much prettier format.\r\n\r\n## Credits<a id=\"sec-1-4\" name=\"sec-1-4\"></a>\r\n\r\nThis configuration for Emacs, i.e. Emacs' Preamble is heavily inspired form (in order):\r\n\r\n-   [@purcell's emacs.d](https://github.com/purcell/emacs.d)\r\n-   [steckemacs](https://github.com/steckerhalter/steckemacs)\r\n\r\n## License<a id=\"sec-1-5\" name=\"sec-1-5\"></a>\r\n\r\n    Copyright (C) 2013  Nikhil Gupta <me@nikhgupta.com>\r\n    Permission is granted to copy, distribute and/or modify this document\r\n    under the terms of the GNU Free Documentation License, Version 1.3\r\n    or any later version published by the Free Software Foundation;\r\n    with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.\r\n    \r\n    Code in this document is free software: you can redistribute it\r\n    and/or modify it under the terms of the GNU General Public\r\n    License as published by the Free Software Foundation, either\r\n    version 3 of the License, or (at your option) any later version.\r\n    \r\n    This code is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\nThis document <http://doc.nikhgupta.com/emacs-preamble.html> which describes my current Emacs\r\nconfiguration (either in its [HTML format](http://doc.nikhgupta.com/emacs-preamble.html) or in its [Org format](http://doc.nikhgupta.com/emacs-preamble.org)) is licensed under the GNU Free\r\nDocumentation License version 1.3 or later (<http://www.gnu.org/copyleft/fdl.html>).\r\n\r\nThe code examples and CSS stylesheets are licensed under the GNU General Public License v3 or later\r\n(<http://www.gnu.org/licenses/gpl.html>).\r\n\r\n## Requirements<a id=\"sec-1-6\" name=\"sec-1-6\"></a>\r\n\r\nI am really unsure about the requirements, but I'm using this configuration in **Mac OSX 10.8.2\r\n(Mountain Lion)**, **GNU Emacs 24.1.1**, and **org-mode v8.2**.\r\n\r\n> **Emacs' Preamble** was designed on `Emacs v24.1.1`, and therefore, I am sure that it will perform, as\r\n> intended, on **Emacs v24+**. Older versions of Emacs might not work properly.\r\n\r\n## Installation<a id=\"sec-1-7\" name=\"sec-1-7\"></a>\r\n\r\nI tried to make sure that **Emacs' Preamble** can be installed in as minimum steps, as possible. At\r\nthe moment, you can simply clone the Github repository on your computer and link `~/.emacs.d` to\r\nthat directory, e.g.:\r\n\r\n    git clone http://github.com/nikhgupta/preamble ~/Code/github/emacs-preamble\r\n    ln -nfs ~/Code/github/emacs-preamble ~/.emacs.d\r\n\r\nThat's it. Now, I'll fire my `emacs` to install the dependencies and packages. I'll sit back for a\r\nwhile, and maybe, a coffee will do me just good, at the moment.\r\n\r\n# Basic Configuration<a id=\"sec-2\" name=\"sec-2\"></a>\r\n\r\n## Initialization<a id=\"sec-2-1\" name=\"sec-2-1\"></a>\r\n\r\n[It all started with a big-bang!](init.el) (in this case, a meager `init.el` file)\r\n\r\n> Oh, yes! Did I mention? I'm a great fan of [The Big Bang Theory](http://en.wikipedia.org/wiki/The_Big_Bang_Theory).\r\n\r\nThe above file, basically, checks to see whether the Org-mode version is above `8.0`. If not, it\r\nupgrades Org-mode by installing it via Emacs' Package Manager, and then tangles and loads `elisp`\r\nsource codes inside the current file by using `org-babel-load-file` function.\r\n\r\nAt the moment, I leave the [Emacs Server](http://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server.html) running on my machine, when it boots up (I, later, plan to\r\nrun it on my VPS, and connect remotely), and use the `emacsclient` commands to connect to it. This\r\nway, this configuration is loaded/tangled only once, providing super-fast experience for my\r\n*use-cases*.\r\n\r\n## Commentary<a id=\"sec-2-2\" name=\"sec-2-2\"></a>\r\n\r\n    ;;; preamble.el --- Emacs' Preamble\r\n    ;;  Author : Nikhil Gupta\r\n    ;;  Email  : me@nikhgupta.com\r\n    \r\n    ;;; Commentary:\r\n    ;;  -----------------------------------------\r\n    ;;  Do not edit the generated file, as it has\r\n    ;;  been generated, as a tangled file, by the\r\n    ;;  stupendous org-mode.\r\n    ;;\r\n    ;;  Make the changes in the corresponding\r\n    ;;  preamble.org file, instead.\r\n    ;;  -----------------------------------------\r\n    \r\n    ;;; Code:\r\n\r\n## Compatibility<a id=\"sec-2-3\" name=\"sec-2-3\"></a>\r\n\r\nSince, this configuration uses features that are new to `Emacs v24`, and since I don't have time\r\nenough to work out a *compatible* configuration for older version of Emacs, display a friendly\r\nwarning, if the Emacs version is below `v24`.\r\n\r\n    (when (version< emacs-version \"24\")\r\n      (warn \"Only Emacs version 24 and up are supported.\"))\r\n\r\n## Debugging<a id=\"sec-2-4\" name=\"sec-2-4\"></a>\r\n\r\n### Why?<a id=\"sec-2-4-1\" name=\"sec-2-4-1\"></a>\r\n\r\nWhen working with such a configuration as this one, I often tend to pull my hair out.. This section\r\nhelps me track down possible causes of such erratic behavior of mine and be more insane,\r\ninstead. Also, I hate those pesky plugins which make my **Emacs' Preamble** configuration far too\r\nslow. This section, further, helps me benchmark my configuration for the exact same purpose.\r\n\r\n### Toggling Debugger<a id=\"sec-2-4-2\" name=\"sec-2-4-2\"></a>\r\n\r\nThe settings of this section are turned on or off via the following variable:\r\n\r\n    (setq debug-on-error 'nil)  ; set to 't to enable debugging messages\r\n\r\n### Checkpoints<a id=\"sec-2-4-3\" name=\"sec-2-4-3\"></a>\r\n\r\nSince, this is one huge file, it is often hard to debug where a particular error has occurred, and\r\ntherefore, I need some visual clue of some type, a.k.a. `checkpoints`. The following functions,\r\ntogether, help me with that. I can, simply, make a call to the `preamble/checkpoint` function, in\r\norder to echo something inside my `*Messages*` buffer, and immediately, know nearby location of\r\nwhere Emacs has stopped loading this configuration. Not to mention, these checkpoints, further, help\r\nme by acting as indirect comments.\r\n\r\n    ;; subtract two time entities\r\n    (defun preamble/time-subtract-millis (b a)\r\n    \"Function that can subtract time string A from time string B.\"\r\n    (* 1000.0 (float-time (time-subtract b a))))\r\n    \r\n    ;; convenient function to measure load-time since initialization\r\n    (defun preamble/load-time()\r\n    \"Return total load-time from the initialization.\"\r\n    (preamble/time-subtract-millis (current-time) before-init-time))\r\n    \r\n    ;; function to display which section is being loaded..\r\n    (defun preamble/checkpoint (msg)\r\n    \"Echo MSG to *Messages*, thereby, making it act as a checkpoint.\"\r\n    (if debug-on-error (message \"- At =%.2fms=, I %s..\" (preamble/load-time) msg)))\r\n    \r\n    ;; an example of above\r\n    (preamble/checkpoint \"initialized benchmarking\")\r\n\r\n### Benchmarking<a id=\"sec-2-4-4\" name=\"sec-2-4-4\"></a>\r\n\r\nMoreover, since, I am a quantified-geek, I love to measure various things. Why not measure time\r\ntaken by our Emacs configuration, as well?\r\n\r\nThis section, also, enables me to measure the time taken by various features in requiring them, as\r\nwell as total time taken by the Emacs to load this configuration. When Emacs load this\r\nconfiguration, it displays which features were `require`'d, and how much time that took. This is,\r\nespecially, useful for debugging which module is making our Emacs start-up, so slow.\r\n\r\n    ;; function to display how much time a particular feature took to require..\r\n    (defun preamble/require-time-message(package time)\r\n      (if debug-on-error ( message\r\n                           \"- At =%.2fms=, I required a feature: =%s=, which took me =%0.2fms=.\"\r\n                           (preamble/load-time) package time)))\r\n    \r\n    (defvar feature-required-time nil \"Require time for a specific feature.\")\r\n    \r\n    (defvar preamble/require-times nil\r\n      \"A list of (FEATURE . LOAD-DURATION).\r\n    LOAD-DURATION is the time taken in milliseconds to load FEATURE.\")\r\n    \r\n    (defadvice require\r\n      (around build-require-times (feature &optional filename noerror) activate)\r\n      \"Note in `preamble/require-times' the time taken to require each feature.\"\r\n      (let* ((already-loaded (memq feature features))\r\n             (require-start-time (and (not already-loaded) (current-time))))\r\n        (prog1\r\n            ad-do-it\r\n          (when (and (not already-loaded) (memq feature features) debug-on-error)\r\n            (setq feature-required-time\r\n                  (preamble/time-subtract-millis (current-time) require-start-time))\r\n            (preamble/require-time-message feature feature-required-time)\r\n            (add-to-list 'preamble/require-times\r\n                         (cons feature\r\n                               (preamble/time-subtract-millis (current-time)\r\n                                                              require-start-time))\r\n                         t)))))\r\n\r\n## Avoid Screen-flickering<a id=\"sec-2-5\" name=\"sec-2-5\"></a>\r\n\r\nNow that, I have `Emacs v24` with me, I would first disable some of the GUI features early in the\r\nstart-up so as to ensure that the screen does not flicker when turning them off, otherwise.\r\n\r\n    (if (fboundp 'menu-bar-mode) (menu-bar-mode -1))\r\n    (if (fboundp 'tool-bar-mode) (tool-bar-mode -1))\r\n    (if (fboundp 'scroll-bar-mode) (scroll-bar-mode -1))\r\n    (setq inhibit-startup-message 't) ; disable ugly start screen\r\n\r\n## Custom Routines<a id=\"sec-2-6\" name=\"sec-2-6\"></a>\r\n\r\n### Variables<a id=\"sec-2-6-1\" name=\"sec-2-6-1\"></a>\r\n\r\n    (defvar preamble-dir\r\n    (file-name-directory (file-truename load-file-name))\r\n    \"The root directory for Emacs' Preamble configuration.\")\r\n    \r\n    (defvar preamble-vendor-dir (concat preamble-dir \"/vendors\")\r\n    \"The directory which contains files from our vendors.\")\r\n    \r\n    (defvar preamble/bookmark-file (expand-file-name \".bookmarks.el\" preamble-dir)\r\n    \"The file where all the bookmarks will be saved.\")\r\n\r\n### Constants<a id=\"sec-2-6-2\" name=\"sec-2-6-2\"></a>\r\n\r\n    (defconst *is-mac* (eq system-type 'darwin))\r\n    (defconst *is-linux* (eq system-type 'gnu/linux))\r\n    (defconst *is-windows* (eq system-type 'windows-nt))\r\n    (defconst *is-cygwin* (eq system-type 'cygwin))\r\n    (defconst *is-mac-gui* (and *is-mac* window-system))\r\n    (defconst *is-cocoa-emacs* (and *is-mac* (eq window-system 'ns)))\r\n    (defconst *spell-check-support-enabled* nil)\r\n\r\n### Macros<a id=\"sec-2-6-3\" name=\"sec-2-6-3\"></a>\r\n\r\n1.  Evaluate `elisp` after feature has loaded\r\n\r\n        (defmacro after (feature &rest body)\r\n            \"After FEATURE is loaded, evaluate BODY.\"\r\n            (declare (indent defun))\r\n            `(eval-after-load ,feature\r\n            '(progn ,@body)))\r\n\r\n### Functions<a id=\"sec-2-6-4\" name=\"sec-2-6-4\"></a>\r\n\r\n1.  Evaluate `elisp` code after initialization\r\n\r\n        (defun preamble/eval-after-init (form)\r\n            \"Add `(lambda () FORM)' to `after-init-hook'.\r\n            If Emacs has already finished initialization, also eval FORM immediately.\"\r\n            (let ((func (list 'lambda nil form)))\r\n            (add-hook 'after-init-hook func)\r\n            (when after-init-time\r\n                (eval form))))\r\n\r\n2.  Greet the user and display load time\r\n\r\n        (defun preamble/greet-user-with-load-time()\r\n            \"Greet and display load time to the user.\"\r\n            (message (concat \"--------------------------------------------------------------------\\n\"\r\n                            \"*Welcome to Emacs' Preamble.*\\n\"\r\n                            \"Emacs' Preamble was loaded in =%.2fms=.\") (preamble/load-time)))\r\n\r\n3.  Add sub-folders of a directory to load path\r\n\r\n    I have added the following function to add all sub-directories inside a given directory to the\r\n    `load-path`.\r\n    \r\n        (defun preamble/add-subfolders-to-load-path (parent-dir)\r\n          \"Add all level PARENT-DIR subdirs to the `load-path'.\"\r\n          (dolist (f (directory-files parent-dir))\r\n            (let ((name (expand-file-name f parent-dir)))\r\n              (when (and (file-directory-p name)\r\n                         (not (equal f \"..\"))\r\n                         (not (equal f \".\")))\r\n                (add-to-list 'load-path name)\r\n                (preamble/add-subfolders-to-load-path name)))))\r\n\r\n4.  Open the most recent buffer, quickly.\r\n\r\n    Define a really handy function to quickly split the current window to open the most recent buffer.\r\n    \r\n        ;; Borrowed from http://postmomentum.ch/blog/201304/blog-on-emacs\r\n        (defun preamble/split-window()\r\n        \"Split the window to see the most recent buffer in the other window.\r\n        Call a second time to restore the original window configuration.\"\r\n        (interactive)\r\n        (if (eq last-command 'preamble/split-window)\r\n            (progn\r\n                (jump-to-register :preamble/split-window)\r\n                (setq this-command 'preamble/unsplit-window))\r\n            (window-configuration-to-register :preamble/split-window)\r\n            (switch-to-buffer-other-window nil)))\r\n\r\n### Settings<a id=\"sec-2-6-5\" name=\"sec-2-6-5\"></a>\r\n\r\nEmacs uses a *custom file* to store changes done via [Emacs' Easy Customization](http://www.gnu.org/software/emacs/manual/html_node/emacs/Easy-Customization.html) method. I'm, simply,\r\nsetting it up below, so that all the custom configuration exists in a separate file.\r\n\r\n    (setq custom-file (expand-file-name \"custom.el\" preamble-dir))\r\n    (load custom-file)\r\n\r\n### Vendors<a id=\"sec-2-6-6\" name=\"sec-2-6-6\"></a>\r\n\r\n`vendors` directory was created for the purpose of putting up *unpublished* packages inside it, via\r\ngit repository cloning. I'm just adding all of its sub-directories to the load path.\r\n\r\n    (mapc 'load (directory-files preamble-vendor-dir 't \"^[^#].*el$\"))\r\n    (preamble/add-subfolders-to-load-path preamble-vendor-dir)\r\n\r\n## General Behavior<a id=\"sec-2-7\" name=\"sec-2-7\"></a>\r\n\r\n### Encoding Support<a id=\"sec-2-7-1\" name=\"sec-2-7-1\"></a>\r\n\r\nSetup encoding used by the Emacs to `utf-8`, thereby, easing out my life.\r\n\r\n    (setq locale-coding-system 'utf-8)\r\n    (set-terminal-coding-system 'utf-8)\r\n    (set-keyboard-coding-system 'utf-8)\r\n    (set-selection-coding-system 'utf-8)\r\n    (prefer-coding-system 'utf-8)\r\n\r\n### Auto-reload external file changes<a id=\"sec-2-7-2\" name=\"sec-2-7-2\"></a>\r\n\r\n    (global-auto-revert-mode)\r\n    (setq global-auto-revert-non-file-buffers t\r\n          auto-revert-verbose nil)\r\n\r\n### Miscelleneous<a id=\"sec-2-7-3\" name=\"sec-2-7-3\"></a>\r\n\r\n    (eval-when-compile (require 'cl))         ; load common lisp\r\n    (fset 'yes-or-no-p 'y-or-n-p)             ; shut up, and be concise\r\n    \r\n    (setq-default gc-cons-threshold 50000000  ; perform garbage collection at 50MB (instead of 0.76MB)\r\n                  buffers-menu-max-size 30    ; max num of entries in Buffers menu\r\n                  compilation-scroll-output t ; scroll down to show last line in compilation mode\r\n                  make-backup-files nil       ; do not make backups for files\r\n                  mouse-yank-at-point t       ; mouse yank at point instead of at click\r\n                  save-interprogram-paste-before-kill t ; save clipboard into kill ring b4 replacing it\r\n                  scroll-preserve-screen-position 'always ; point keeps its position when scrolling\r\n                  set-mark-command-repeat-pop t ; repeating C-SPC after popping mark pops it again\r\n                  grep-scroll-output t\r\n                  grep-highlight-matches t\r\n                  bookmark-default-file preamble/bookmark-file ; default bookmark file\r\n                  ediff-split-window-function 'split-window-horizontally\r\n                  ediff-window-setup-function 'ediff-setup-windows-plain\r\n                  ring-bell-function 'ignore)\r\n\r\n## General Appearance<a id=\"sec-2-8\" name=\"sec-2-8\"></a>\r\n\r\n### Editor<a id=\"sec-2-8-1\" name=\"sec-2-8-1\"></a>\r\n\r\n    (global-linum-mode)           ; display line numbers\r\n    \r\n    (setq-default blink-cursor-delay 0        ; seconds after which cursor starts to blink\r\n                  blink-cursor-interval 0.4   ; length of cursor blink interval\r\n                  line-spacing 0.2            ; space to put between lines\r\n    )\r\n\r\n### Modeline<a id=\"sec-2-8-2\" name=\"sec-2-8-2\"></a>\r\n\r\n    (column-number-mode)                    ; display column number in mode line\r\n\r\n### WhiteSpace<a id=\"sec-2-8-3\" name=\"sec-2-8-3\"></a>\r\n\r\nI despise `whitespace`, esp. the freaky trailing ones. So, I explicitely set them to be visible,\r\nand automatically remove them when buffer is saved.\r\n\r\n    (setq show-trailing-whitespace 't)        ; show trailing whitespace in editor\r\n    (add-hook 'before-save-hook 'delete-trailing-whitespace) ; delete them when buffer is saved\r\n    \r\n    ;; do not show trailing whitespace in some modes\r\n    (dolist (hook '(term-mode-hook comint-mode-hook compilation-mode-hook))\r\n      (add-hook hook (lambda () (setq show-trailing-whitespace nil))))\r\n\r\n### Word Wrapping<a id=\"sec-2-8-4\" name=\"sec-2-8-4\"></a>\r\n\r\n    (setq-default truncate-lines nil         ; display continuation lines\r\n                  truncate-partial-width-windows nil)\r\n\r\n### Font Settings<a id=\"sec-2-8-5\" name=\"sec-2-8-5\"></a>\r\n\r\nI love syntax highlighting.\r\n\r\n    (global-font-lock-mode 1)\r\n\r\nSpecify the default font as `Source Code Pro`, which should already be [downloaded](http://blogs.adobe.com/typblography/2012/09/source-code-pro.html) and installed.\r\n\r\n    (set-frame-font \"Source Code Pro\")\r\n    (set-face-attribute 'default nil :font \"Source Code Pro\" :height 140)\r\n    (set-face-font 'default \"Source Code Pro\")\r\n\r\n### Disable GUI dialog boxes<a id=\"sec-2-8-6\" name=\"sec-2-8-6\"></a>\r\n\r\n    (setq use-file-dialog 'nil) ; use mini-buffer for file dialogs\r\n    (setq use-dialog-box  'nil) ; use mini-buffer for everythin' else..\r\n    (eval '(setq inhibit-startup-echo-area-message \"nikhgupta\"))\r\n\r\n### Miscelleneous<a id=\"sec-2-8-7\" name=\"sec-2-8-7\"></a>\r\n\r\n    (setq-default tooltip-delay 1.5         ; seconds to wait before displaying tooltip\r\n                  visible-bell t            ; try to flash the frame to represent bell\r\n                  indicate-empty-lines t    ; show an indicator in left fringe for lines not in buffer\r\n                  )\r\n\r\n## Editor Behaviour<a id=\"sec-2-9\" name=\"sec-2-9\"></a>\r\n\r\n### Modes<a id=\"sec-2-9-1\" name=\"sec-2-9-1\"></a>\r\n\r\n    (electric-pair-mode)               ; automatically insert delimiter pairs\r\n    (delete-selection-mode)            ; typed text replaces the active selection\r\n    (transient-mark-mode)              ; highlight the region when mark is active\r\n    (cua-selection-mode 't)            ; for rectangular selections, CUA is nice\r\n    (show-paren-mode)                  ; show matching parenthesis\r\n    (global-visual-line-mode)          ; soft wrapping of lines\r\n    \r\n    (setq-default case-fold-search t   ; searches and matches should ignore case\r\n                  indent-tabs-mode nil ; indentation can not insert tabs\r\n                  tab-width 2          ; a TAB is 2 spaces, by default\r\n                  fill-column 100)\r\n\r\n### Enable some disabled commands<a id=\"sec-2-9-2\" name=\"sec-2-9-2\"></a>\r\n\r\nWe do not want to disable narrowing commands, or case-change functions.\r\n\r\n    (put 'narrow-to-region 'disabled nil)\r\n    (put 'narrow-to-page 'disabled nil)\r\n    (put 'narrow-to-defun 'disabled nil)\r\n    (put 'upcase-region 'disabled nil)\r\n    (put 'downcase-region 'disabled nil)\r\n\r\n### Functions<a id=\"sec-2-9-3\" name=\"sec-2-9-3\"></a>\r\n\r\n    (autoload 'zap-up-to-char \"misc\" \"Kill up to, but not including\r\n    ARGth occurrence of CHAR.\")\r\n    \r\n    (defun Preamble/duplicate-region (beg end)\r\n      \"Insert a copy of the current region after the region.\"\r\n      (interactive \"r\")\r\n      (save-excursion\r\n        (goto-char end)\r\n        (insert (buffer-substring beg end))))\r\n    \r\n    (defun preamble/duplicate-line-or-region (prefix)\r\n      \"Duplicate either the current line or any current region.\"\r\n      (interactive \"*p\")\r\n      (whole-line-or-region-call-with-region 'preamble/duplicate-region prefix t))\r\n    \r\n    (defun preamble/kill-back-to-indentation ()\r\n      \"Kill from point back to the first non-whitespace character on the line.\"\r\n      (interactive)\r\n      (let ((prev-pos (point)))\r\n        (back-to-indentation)\r\n        (kill-region (point) prev-pos)))\r\n    \r\n    (defun preamble/sort-lines-random (beg end)\r\n      \"Sort lines in region randomly.\"\r\n      (interactive \"r\")\r\n      (save-excursion\r\n        (save-restriction\r\n          (narrow-to-region beg end)\r\n          (goto-char (point-min))\r\n          (let ;; To make `end-of-line' and etc. to ignore fields.\r\n              ((inhibit-field-text-motion t))\r\n            (sort-subr nil 'forward-line 'end-of-line nil nil\r\n                       (lambda (s1 s2) (eq (random 2) 0)))))))\r\n    \r\n    (defun preamble/open-line-with-reindent (n)\r\n      \"A version of `open-line' which reindents the start and end positions.\r\n    If there is a fill prefix and/or a `left-margin', insert them\r\n    on the new line if the line would have been blank.\r\n    With arg N, insert N newlines.\"\r\n      (interactive \"*p\")\r\n      (let* ((do-fill-prefix (and fill-prefix (bolp)))\r\n             (do-left-margin (and (bolp) (> (current-left-margin) 0)))\r\n             (loc (point-marker))\r\n             ;; Don't expand an abbrev before point.\r\n             (abbrev-mode nil))\r\n        (delete-horizontal-space t)\r\n        (newline n)\r\n        (indent-according-to-mode)\r\n        (when (eolp)\r\n          (delete-horizontal-space t))\r\n        (goto-char loc)\r\n        (while (> n 0)\r\n          (cond ((bolp)\r\n                 (if do-left-margin (indent-to (current-left-margin)))\r\n                 (if do-fill-prefix (insert-and-inherit fill-prefix))))\r\n          (forward-line 1)\r\n          (setq n (1- n)))\r\n        (goto-char loc)\r\n        (end-of-line)\r\n        (indent-according-to-mode)))\r\n\r\n## Always Run Server<a id=\"sec-2-10\" name=\"sec-2-10\"></a>\r\n\r\n    (require 'server)\r\n    (unless (server-running-p)\r\n        (server-start))\r\n\r\n# Packages<a id=\"sec-3\" name=\"sec-3\"></a>\r\n\r\n## Repositories<a id=\"sec-3-1\" name=\"sec-3-1\"></a>\r\n\r\nOK, so I am using the default [Package Manager](http://www.emacswiki.org/emacs/ELPA) that is shipped with Emacs 24 to load my packages\r\n(anything else, does not make sense, anyways). However, I must, first, tell it to use more sources\r\nto search for a given package (a.k.a. `yum`). I am using [Marmalade](http://www.emacswiki.org/emacs-en/Marmalade), [MELPA](http://www.emacswiki.org/emacs-en/MELPA), & [Org ELPA](http://orgmode.org/elpa.html) repositories,\r\nfor this purpose.\r\n\r\n    (require 'package)\r\n    (setq package-archives\r\n          '((\"marmalade\" . \"http://marmalade-repo.org/packages/\")\r\n            (\"org\"       . \"http://orgmode.org/elpa/\")\r\n            (\"melpa\"     . \"http://melpa.milkbox.net/packages/\")))\r\n    (package-initialize)\r\n\r\n## On Demand Installation<a id=\"sec-3-2\" name=\"sec-3-2\"></a>\r\n\r\nI have added some convenient functions to install a package, only when it is explicitely told to do\r\nso, which means that instead of adding these packages to the list of our packages (that need to be\r\ninstalled and checked on every run of Emacs) in the next section, we are now able to `install` them\r\nright along with the rest of their configuration. This is called **On Demand Installation** of the\r\npackages.\r\n\r\n    ;; on-demand installation of a package\r\n    (defun preamble/require-package (package &optional min-version no-refresh)\r\n      \"Install given PACKAGE, optionally requiring MIN-VERSION.\r\n    If NO-REFRESH is non-nil, the available package lists will not be\r\n    re-downloaded in order to locate PACKAGE.\"\r\n      (if (package-installed-p package min-version)\r\n          t\r\n        (if (or (assoc package package-archive-contents) no-refresh)\r\n            (package-install package)\r\n          (progn\r\n            (package-refresh-contents)\r\n            (preamble/require-package package min-version t)))))\r\n    \r\n    ;; on-demand installation of multiple packages\r\n    (defun preamble/require-packages(packages-list)\r\n      \"Install packages from a given PACKAGES-LIST, using `preamble-require-package' function.\"\r\n      (mapc #'preamble/require-package packages-list))\r\n\r\n## Trivial Packages<a id=\"sec-3-3\" name=\"sec-3-3\"></a>\r\n\r\nSome packages are really trivial in nature, and nearly, need no configuration, at all. I have marked\r\nsuch packages to be installed, in this section. That way, I won't have to clobber up the\r\nconfiguration with different headings, and the likes.\r\n\r\n### Functions<a id=\"sec-3-3-1\" name=\"sec-3-3-1\"></a>\r\n\r\n    (defun preamble/install-packages ()\r\n      \"Install all packages listed in `preamble-trivial-packages'.\"\r\n      (unless (every #'package-installed-p preamble-trivial-packages)\r\n        (preamble/require-packages preamble-trivial-packages)))\r\n\r\n### Installed Packages<a id=\"sec-3-3-2\" name=\"sec-3-3-2\"></a>\r\n\r\n    (defvar preamble-trivial-packages '( dash\r\n                                         diminish\r\n                                         expand-region\r\n                                         flycheck\r\n                                         regex-tool\r\n                                         smex)\r\n      \"A list of trivial packages that are installed on startup.\")\r\n    \r\n    (preamble/install-packages)\r\n\r\n## File-type Specific Packages<a id=\"sec-3-4\" name=\"sec-3-4\"></a>\r\n\r\nI have added a macro `preamble/auto-install` to automatically install the appropriate mode for a\r\nfile with given extension, when it is opened. Furthermore, the macro ensures that the file is, then,\r\nopened in that mode. This can be used to automatically install the required packages for a specific\r\nfiletype.\r\n\r\n### Map exntensions to modes<a id=\"sec-3-4-1\" name=\"sec-3-4-1\"></a>\r\n\r\n    (defvar preamble/auto-install-alist\r\n      '((\"\\\\.clj\\\\'\" clojure-mode clojure-mode)\r\n        (\"\\\\.coffee\\\\'\" coffee-mode coffee-mode)\r\n        (\"\\\\.css\\\\'\" css-mode css-mode)\r\n        (\"\\\\.csv\\\\'\" csv-mode csv-mode)\r\n        (\"\\\\.d\\\\'\" d-mode d-mode)\r\n        (\"\\\\.dart\\\\'\" dart-mode dart-mode)\r\n        (\"\\\\.erl\\\\'\" erlang erlang-mode)\r\n        (\"\\\\.feature\\\\'\" feature-mode feature-mode)\r\n        (\"\\\\.go\\\\'\" go-mode go-mode)\r\n        (\"\\\\.groovy\\\\'\" groovy-mode groovy-mode)\r\n        (\"\\\\.haml\\\\'\" haml-mode haml-mode)\r\n        (\"\\\\.hs\\\\'\" haskell-mode haskell-mode)\r\n        (\"\\\\.latex\\\\'\" auctex LaTeX-mode)\r\n        (\"\\\\.less\\\\'\" less-css-mode less-css-mode)\r\n        (\"\\\\.lua\\\\'\" lua-mode lua-mode)\r\n        (\"\\\\.markdown\\\\'\" markdown-mode markdown-mode)\r\n        (\"\\\\.mkd\\\\'\" markdown-mode markdown-mode)\r\n        (\"\\\\.md\\\\'\" markdown-mode markdown-mode)\r\n        (\"\\\\.ml\\\\'\" tuareg tuareg-mode)\r\n        (\"\\\\.pp\\\\'\" puppet-mode puppet-mode)\r\n        (\"\\\\.php\\\\'\" php-mode php-mode)\r\n        (\"PKGBUILD\\\\'\" pkgbuild-mode pkgbuild-mode)\r\n        (\"\\\\.sass\\\\'\" sass-mode sass-mode)\r\n        (\"\\\\.scala\\\\'\" scala-mode2 scala-mode)\r\n        (\"\\\\.scss\\\\'\" scss-mode scss-mode)\r\n        (\"\\\\.slim\\\\'\" slim-mode slim-mode)\r\n        (\"\\\\.textile\\\\'\" textile-mode textile-mode)\r\n        (\"\\\\.yml\\\\'\" yaml-mode yaml-mode))\r\n      \"A list of filetype vs mode mappings.\")\r\n\r\n### Add filetype mapping to `auto-mode-alist`<a id=\"sec-3-4-2\" name=\"sec-3-4-2\"></a>\r\n\r\n    (defmacro preamble/auto-install (extension package mode)\r\n      \"When file with EXTENSION is opened triggers auto-install of PACKAGE.\r\n    PACKAGE is installed only if not already present.  The file is opened in MODE.\"\r\n      `(add-to-list 'auto-mode-alist\r\n                    `(,extension . (lambda ()\r\n                                     (unless (package-installed-p ',package)\r\n                                       (package-install ',package))\r\n                                     (,mode)))))\r\n    \r\n    (mapc (lambda (entry)\r\n            (let ((extension (car entry))\r\n                  (package (cadr entry))\r\n                  (mode (cadr (cdr entry))))\r\n              (unless (package-installed-p package)\r\n                (preamble/auto-install extension package mode))))\r\n          preamble/auto-install-alist)\r\n    \r\n    ;; some modes don't have autoloads for the auto-mode-alist\r\n    ;; so we add them manually if package is already installed\r\n    (when (package-installed-p 'markdown-mode)\r\n      (add-to-list 'auto-mode-alist '(\"\\\\.markdown\\\\'\" . markdown-mode))\r\n      (add-to-list 'auto-mode-alist '(\"\\\\.md\\\\'\" . markdown-mode)))\r\n    (when (package-installed-p 'pkgbuild-mode)\r\n      (add-to-list 'auto-mode-alist '(\"PKGBUILD\\\\'\" . pkgbuild-mode)))\r\n\r\n# User Interface<a id=\"sec-4\" name=\"sec-4\"></a>\r\n\r\n> An editor can only improve my efficiency, if it pleases my eyes.\r\n> &#x2014; [Nikhil Gupta](http://github.com/nikhgupta)\r\n\r\nThis is true, since I work for almost 12-16 hours on my computer, with almost 70% time either in\r\nmy Shell or in my Editor, and hence, these two things need to be so adorable, and so damn\r\nimpressive, that I would never want to leave them alone.\r\n\r\n## Themes<a id=\"sec-4-1\" name=\"sec-4-1\"></a>\r\n\r\n### Functions<a id=\"sec-4-1-1\" name=\"sec-4-1-1\"></a>\r\n\r\n    ;; ensures that themes will be applied even if they have not been customized\r\n    (defun preamble/reapply-themes ()\r\n      \"Forcibly load the themes listed in `custom-enabled-themes'.\"\r\n      (dolist (theme custom-enabled-themes)\r\n        (unless (custom-theme-p theme) (load-theme theme)))\r\n      (custom-set-variables `(custom-enabled-themes (quote ,custom-enabled-themes))))\r\n    \r\n    ;; lets run the above function after Emacs has loaded this configuration.\r\n    (add-hook 'after-init-hook 'preamble/reapply-themes)\r\n\r\n### Installed Themes<a id=\"sec-4-1-2\" name=\"sec-4-1-2\"></a>\r\n\r\nI am in love with elegance, and only prefer the themes which show such elegance. Emacs' Preamble\r\nuses a very specific set of 5 themes (or theme groups) at any time, since as per me, I would never\r\nneed more than that, even if I am bored.\r\n\r\n    (preamble/require-packages '( noctilux-theme zenburn-theme sublime-themes\r\n                                                 color-theme-sanityinc-solarized\r\n                                                 color-theme-sanityinc-tomorrow base16-theme ))\r\n\r\n### Current Theme<a id=\"sec-4-1-3\" name=\"sec-4-1-3\"></a>\r\n\r\n    (setq-default custom-enabled-themes '(sanityinc-tomorrow-eighties))\r\n\r\n### Quick Access to Themes<a id=\"sec-4-1-4\" name=\"sec-4-1-4\"></a>\r\n\r\n    ;; quick access for some themes, I use often.\r\n    (defun light() \"Activate a light color theme.\"\r\n      (interactive) (color-theme-sanityinc-solarized-light))\r\n    (defun dark() \"Activate a dark color theme.\"\r\n      (interactive) (color-theme-sanityinc-solarized-dark))\r\n    (defun eighties() \"Activate an 80's theme.\"\r\n      (interactive) (color-theme-sanityinc-tomorrow-eighties))\r\n    (defun day() \"Activate theme for a day.\"\r\n      (interactive) (color-theme-sanityinc-tomorrow-day))\r\n    (defun night() \"Activate theme for a night.\"\r\n      (interactive) (color-theme-sanityinc-tomorrow-night))\r\n\r\n## Frame and Windows<a id=\"sec-4-2\" name=\"sec-4-2\"></a>\r\n\r\n### Fullscreen Support<a id=\"sec-4-2-1\" name=\"sec-4-2-1\"></a>\r\n\r\nSimple fullscreen support for Emacs. Note that, Emacs in OSX already has a fullscreen support, and a\r\nsimilar support is built-in inside Emacs v24.4+.\r\n\r\n    (defun preamble/fullscreen ()\r\n      \"Make Emacs window fullscreen.\r\n      This follows freedesktop standards, should work in X servers.\"\r\n      (interactive)\r\n      (if (eq window-system 'x)\r\n          (x-send-client-message nil 0 nil \"_NET_WM_STATE\" 32\r\n                                 '(2 \"_NET_WM_STATE_FULLSCREEN\" 0))\r\n        (error \"Only X server is supported\")))\r\n\r\n### Better Frame Title<a id=\"sec-4-2-2\" name=\"sec-4-2-2\"></a>\r\n\r\n    (setq frame-title-format\r\n    '((:eval (if (buffer-file-name)\r\n        (abbreviate-file-name (buffer-file-name)) \"%b\"))))\r\n\r\n### Adjust Frame's Opacity<a id=\"sec-4-2-3\" name=\"sec-4-2-3\"></a>\r\n\r\n    (defun preamble/adjust-opacity (frame incr)\r\n      (let* ((oldalpha (or (frame-parameter frame 'alpha) 100))\r\n             (newalpha (+ incr oldalpha)))\r\n        (when (and (<= frame-alpha-lower-limit newalpha) (>= 100 newalpha))\r\n          (modify-frame-parameters frame (list (cons 'alpha newalpha))))))\r\n\r\n### Mouse Support in Terminal<a id=\"sec-4-2-4\" name=\"sec-4-2-4\"></a>\r\n\r\nWhen making new Terminal, i.e. `tty` frames in Emacs, I want to ensure that I am able to use mouse\r\nthere, as well as paste by clicking mouse middle button.\r\n\r\n    (xterm-mouse-mode)\r\n    (when (fboundp 'mwheel-install) (mwheel-install))\r\n    (setq mouse-wheel-scroll-amount '(1 ((shift) . 1))) ;; one line at a time\r\n    (setq mouse-wheel-progressive-speed nil) ;; don't accelerate scrolling\r\n    (setq mouse-wheel-follow-mouse 't) ;; scroll window under mouse\r\n    (setq scroll-step 1) ;; keyboard scroll one line at a time\r\n    (setq scroll-conservatively 10000)\r\n    (setq auto-window-vscroll nil)\r\n\r\n### Switching between Windows<a id=\"sec-4-2-5\" name=\"sec-4-2-5\"></a>\r\n\r\nSwitching windows, when more than 2 of them are open, with `C-x o` is a real pain in the fingers\r\nand eyes, therefore, I make use of the really nice [switch-window](http://github.com/dimitri/switch-window) package, as well as the\r\n`winner-mode` built-in Emacs. Winner Mode allows us to *undo* (and *redo*) changes in the window\r\nconfiguration with the key commands `C-c left`, and `C-c right` (which, is pretty neat!)\r\n\r\n    (when (fboundp 'winner-mode) (winner-mode))\r\n    \r\n    (preamble/require-package 'switch-window)\r\n    (require 'switch-window)\r\n    ;; we must bind the \"C-x o\" key appropriately, now.\r\n    (setq switch-window-shortcut-style 'quail)\r\n\r\n# Basic Modules<a id=\"sec-5\" name=\"sec-5\"></a>\r\n\r\nModules defines either a package or a mode or both, and this section defines various modules along\r\nwith the relevant configuration required by them. Each module is tagged with appropriate tags to\r\nrefer to the kind of feature, it provides, e.g. a module can be tagged as `editor`, which means that\r\nthe module provides a feature related to the editing inside Emacs.\r\n\r\n## auto-complete<a id=\"sec-5-1\" name=\"sec-5-1\"></a>\r\n\r\n[AutoComplete](http://www.emacswiki.org/emacs/AutoComplete) is an excellent auto-completion feature with popup menu for quick selection. It can\r\ncomplete words at the point from a number of different sources, and includes fuzzy-matching,\r\nin-built.\r\n\r\nI have, first, setup **AutoComplete** as the default completion function, by hooking it inside\r\n`auto-complete-mode`.\r\n\r\n    (preamble/require-package 'auto-complete)\r\n    (require 'auto-complete-config)\r\n    \r\n    (defun preamble/auto-complete-at-point ()\r\n    \"Use AutoComplete to provide completion at the current point.\"\r\n    (when (and (not (minibufferp))\r\n                (fboundp 'auto-complete-mode)\r\n                auto-complete-mode)\r\n        (auto-complete)))\r\n    \r\n    ;; hook AC into completion-at-point\r\n    (defun preamble/set-auto-complete-as-completion-at-point-function ()\r\n    \"Set AutoComplete as Completion-At-Point function.\"\r\n    (add-to-list 'completion-at-point-functions 'preamble/auto-complete-at-point))\r\n    \r\n    (add-hook 'auto-complete-mode-hook 'preamble/set-auto-complete-as-completion-at-point-function)\r\n\r\nI want to customize behavior of AC to match my workflow, and have setup `TAB` key to trigger\r\ncompletions. Further, I want to exclude very large buffer from interfering with AC.\r\n\r\n    (global-auto-complete-mode)          ; enable auto-complete mode globally\r\n    \r\n    (after 'auto-complete\r\n      (setq ac-expand-on-auto-complete t ; auto-complete whole match on TAB\r\n            ac-auto-start 3              ; enable auto-complete after 3 chars\r\n            ac-dwim nil                  ; get pop-ups with docs even if word is uniquely completed\r\n            tab-always-indent 'complete  ; use TAB to trigger auto-complete\r\n            dabbrev-friend-buffer-function\r\n              '(lambda() (< (buffer-size other-buffer (1024 1024))))) ; exclude large buffers\r\n      (add-to-list 'completion-styles 'initials t))\r\n\r\nFinally, define some sources for AC, and setup some modes to use AC, by default.\r\n\r\n    (after 'auto-complete\r\n      ;; define sources for auto-completion\r\n      (set-default 'ac-sources '( ac-source-imenu ac-source-dictionary\r\n                                                  ac-source-words-in-buffer\r\n                                                  ac-source-words-in-same-mode-buffers\r\n                                                  ac-source-words-in-all-buffer))\r\n    \r\n      ;; add various modes to auto-complete\r\n      (dolist (mode '(magit-log-edit-mode log-edit-mode org-mode\r\n                                          text-mode haml-mode ruby-mode sass-mode yaml-mode\r\n                                          csv-mode espresso-mode haskell-mode html-mode\r\n                                          nxml-mode sh-mode smarty-mode clojure-mode\r\n                                          lisp-mode textile-mode markdown-mode tuareg-mode\r\n                                          js3-mode css-mode less-css-mode sql-mode\r\n                                          ielm-mode))\r\n        (add-to-list 'ac-modes mode)))\r\n\r\n## diminish<a id=\"sec-5-2\" name=\"sec-5-2\"></a>\r\n\r\n[Diminished modes](http://www.emacswiki.org/emacs/DiminishedModes) is an internal feature, which lets us fight mode-line clutter by diminishing\r\n(removing or abbreviating) minor mode indicators in the modeline.\r\n\r\n    (preamble/require-package 'diminish)\r\n\r\n### Diminishing Major Modes<a id=\"sec-5-2-1\" name=\"sec-5-2-1\"></a>\r\n\r\n    (add-hook 'emacs-lisp-mode-hook (lambda() (setq mode-name \"eL\"))) ; emacs lisp\r\n\r\n## dired<a id=\"sec-5-3\" name=\"sec-5-3\"></a>\r\n\r\n[Dired+](http://www.emacswiki.org/emacs/DiredPlus) enhances our file-exploring experience, and provides additional features to [Dired Mode](http://www.emacswiki.org/emacs/Dired).\r\n\r\n    (preamble/require-package 'dired+)\r\n    (setq diredp-hide-details-initially-flag nil\r\n          global-dired-hide-details-mode -1)\r\n    (after 'dired\r\n      (require 'dired+)\r\n      (setq dired-recursive-deletes 'top))\r\n    ;; disable line wrapping in dired mode\r\n    (add-hook 'dired-mode-hook (lambda () (setq truncate-lines t)))\r\n\r\n### Related Key Bindings<a id=\"sec-5-3-1\" name=\"sec-5-3-1\"></a>\r\n\r\n    (after 'dired\r\n      (define-key dired-mode-map [mouse-2] 'dired-find-file))\r\n\r\n## fci-mode<a id=\"sec-5-4\" name=\"sec-5-4\"></a>\r\n\r\nMany modern editors and IDEs can graphically indicate the location of the fill column by drawing a\r\nthin line (in design parlance, a \"rule\") down the length of the editing window. `fci-mode`,\r\ni.e. [Fill Column Indicator](https://github.com/alpaker/Fill-Column-Indicator) implements this facility in Emacs.\r\n\r\n    (preamble/require-package 'fill-column-indicator)\r\n    (after 'fill-column-indicator\r\n      (setq fci-rule-width 10)\r\n      (setq fci-rule-character ?❚)\r\n    ; (setq fci-rule-character-color \"#999999\")\r\n      (setq fci-dash-pattern 1.00))\r\n\r\nHowever, I only want to see column indicator when one of the `org-mode`, `text-mode` or `prog-mode`\r\nis active. Moreover, whenever I switch themes, I would like to regenerate the indicator. Lastly,\r\n`fci-mode` is not compatible with `show-trailing-whitespace` property, and hence, I have added a\r\nfunction to properly activate `fci-mode` in this case.\r\n\r\n    (defun preamble/fci-mode-settings()\r\n      \"Turn of `fci-mode' properly, when trailing whitespace is being shown.\"\r\n      (turn-on-fci-mode)\r\n      (when show-trailing-whitespace\r\n        (set (make-local-variable 'whitespace-style) '(face trailing))\r\n        (whitespace-mode)))\r\n    \r\n    ;; enable `fci-mode' in `org-mode' and programming mode\r\n    (add-hook 'prog-mode-hook 'preamble/fci-mode-settings)\r\n    (add-hook 'org-mode-hook  'preamble/fci-mode-settings)\r\n    \r\n    ;; regenerate fci-mode line images after switching themes\r\n    (defadvice enable-theme (after recompute-fci-face activate)\r\n      (dolist (buffer (buffer-list))\r\n        (with-current-buffer buffer\r\n          (when (and (boundp 'fci-mode) fci-mode)\r\n            (turn-on-fci-mode)))))\r\n\r\n## flycheck<a id=\"sec-5-5\" name=\"sec-5-5\"></a>\r\n\r\n[FlyCheck](http://github.com/flycheck/flycheck) is a modern on-the-fly syntax-checker for GNU Emacs, which selects syntax-checkers based on\r\nthe major mode of the current buffer.\r\n\r\n    (preamble/require-package 'flycheck)\r\n    (add-hook 'after-init-hook 'global-flycheck-mode)\r\n\r\n## hippie-expand<a id=\"sec-5-6\" name=\"sec-5-6\"></a>\r\n\r\n> [HippieExpand](http://www.emacswiki.org/emacs/HippieExpand) looks at the word before point and tries to expand it in various ways including\r\n> expanding from a fixed list (like `expand-abbrev`), expanding from matching text found in a\r\n> buffer (like `dabbrev-expand`) or expanding in ways defined by your own functions. Which of\r\n> these it tries and in what order is controlled by a configurable list of functions.\r\n\r\nAs stated above, `hippie-expand` uses a list of functions, which has been defined below in our case:\r\n\r\n    (after 'hippie-expand\r\n      (setq hippie-expand-try-functions-list\r\n              '(try-complete-file-name-partially\r\n              try-complete-file-name\r\n              try-expand-dabbrev\r\n              try-expand-dabbrev-all-buffers\r\n              try-expand-dabbrev-from-kill)))\r\n\r\n## ibuffer<a id=\"sec-5-7\" name=\"sec-5-7\"></a>\r\n\r\n[ibuffer-vc](https://github.com/purcell/ibuffer-vc) adds functionality to Emacs' [iBuffer Mode](http://www.emacswiki.org/emacs/IbufferMode) by grouping buffers according to their parent\r\nVC (version-control) root directory, and by displaying and/or sorting files by their VC status.\r\nTherefore, `ibuffer-mode` will, now, show different groups of buffers based on the `git` repository\r\npath. *Pretty Awesome!*\r\n\r\nFirst, lets make sure that the buffers are grouped according to version control system, they are\r\nin, then by filename or process name.\r\n\r\n    (preamble/require-package 'ibuffer-vc)\r\n    (after 'ibuffer (require 'ibuffer-vc))\r\n    \r\n    (defun preamble/ibuffer-set-up-preferred-filters ()\r\n      \"Sort ibuffers according to Version Control or Filename or Process.\"\r\n      (ibuffer-vc-set-filter-groups-by-vc-root)\r\n      (unless (eq ibuffer-sorting-mode 'filename/process)\r\n        (ibuffer-do-sort-by-filename/process)))\r\n    \r\n    (add-hook 'ibuffer-hook 'preamble/ibuffer-set-up-preferred-filters)\r\n\r\nNow, the default display of `dired` command is a bit non-resonating with what my eyes want to see,\r\nand therefore, lets change the configuration of `ibuffer` to suit my pair of eyes.\r\n\r\n    (after 'ibuffer\r\n      ;; use human readable size column instead of original one\r\n      (define-ibuffer-column size-h\r\n        (:name \"Size\" :inline t)\r\n        (cond\r\n         ((> (buffer-size) 1000000) (format \"%7.1fM\" (/ (buffer-size) 1000000.0)))\r\n         ((> (buffer-size) 1000) (format \"%7.1fk\" (/ (buffer-size) 1000.0)))\r\n         (t (format \"%8d\" (buffer-size))))))\r\n    \r\n    ;; modify the default ibuffer-formats\r\n    (setq ibuffer-formats\r\n          '((mark modified read-only vc-status-mini \" \"\r\n                  (name 18 18 :left :elide)         \" \"\r\n                  (size-h 9 -1 :right)              \" \"\r\n                  (mode 16 16 :left :elide)         \" \"\r\n                  (vc-status 16 16 :left)           \" \"\r\n                  filename-and-process)))\r\n    \r\n    (setq ibuffer-filter-group-name-face 'font-lock-doc-face)\r\n\r\n## ido-mode<a id=\"sec-5-8\" name=\"sec-5-8\"></a>\r\n\r\n[IDO Mode](http://www.emacswiki.org/emacs/InteractivelyDoThings) is, simply, amazin'! It lets us do things interactively with buffers and files. When\r\ncombined with [IDO Ubiquitous](https://github.com/technomancy/ido-ubiquitous) and [Smex](https://github.com/nonsequitur/smex), it creates a powerful combination of fuzzy-file searching\r\nand the same power is available for executings commands, as well as a heap of other places.\r\n\r\n### Bug-Fix<a id=\"sec-5-8-1\" name=\"sec-5-8-1\"></a>\r\n\r\n    ;; suppress warnings from ido-ubiquitous\r\n    (defvar predicate 'nil)\r\n    (defvar inherit-input-method 'nil)\r\n    (defvar ido-cur-item 'nil)\r\n    (defvar ido-default-item 'nil)\r\n    (defvar ido-cur-list 'nil)\r\n\r\n### Configuration<a id=\"sec-5-8-2\" name=\"sec-5-8-2\"></a>\r\n\r\n    (preamble/require-packages '( smex idomenu ido-ubiquitous))\r\n    \r\n    (ido-mode)                              ; enable ido mode\r\n    (ido-everywhere)                        ; use ido-mode wherever possible\r\n    (ido-ubiquitous-mode)                   ; enable ido-ubiquitous\r\n    (setq ido-enable-flex-matching 't       ; enable fuzzy search\r\n          ido-use-filename-at-point 'nil    ; look for filename at point\r\n          ido-use-virtual-buffers 't        ; allow me to open closed buffers, even\r\n          ido-auto-merge-work-directories-length 0\r\n          ido-default-buffer-method 'selected-window) ; allow buffer to be open in different frames\r\n\r\n### Functions<a id=\"sec-5-8-3\" name=\"sec-5-8-3\"></a>\r\n\r\n    (defun preamble/ido-choose-from-recentf ()\r\n      \"Use ido to select a recently opened file from the `recentf-list'.\"\r\n      (interactive)\r\n      (if (and ido-use-virtual-buffers (fboundp 'ido-toggle-virtual-buffers))\r\n          (ido-switch-buffer)\r\n        (find-file (ido-completing-read \"Open file: \" recentf-list nil t))))\r\n\r\n## isearch<a id=\"sec-5-9\" name=\"sec-5-9\"></a>\r\n\r\n[Incremental Search](http://www.emacswiki.org/emacs/IncrementalSearch), i.e. Emacs' `isearch` is the Incremental Search feature of Emacs, and while it\r\nis really nice on its own, it may need some basic extensions and features related to it.\r\n\r\n### Functions<a id=\"sec-5-9-1\" name=\"sec-5-9-1\"></a>\r\n\r\n1.  Search for Current Word\r\n\r\n        ;; Search back/forth for the symbol at point\r\n        ;; See http://www.emacswiki.org/emacs/SearchAtPoint\r\n        (defun preamble/isearch-yank-symbol ()\r\n        \"*Put symbol at current point into search string.\"\r\n        (interactive)\r\n        (let ((sym (symbol-at-point)))\r\n            (if sym\r\n                (progn\r\n                (setq isearch-regexp t\r\n                        isearch-string (concat \"\\\\_<\" (regexp-quote (symbol-name sym)) \"\\\\_>\")\r\n                        isearch-message (mapconcat 'isearch-text-char-description isearch-string \"\")\r\n                        isearch-yank-flag t))\r\n            (ding)))\r\n        (isearch-search-and-update))\r\n\r\n2.  Zap till First Match\r\n\r\n        ;; http://www.emacswiki.org/emacs/ZapToISearch\r\n        (defun zap-to-isearch (rbeg rend)\r\n        \"Kill the region between the mark and the closest portion of\r\n        the isearch match string. The behaviour is meant to be analogous\r\n        to zap-to-char; let's call it zap-to-isearch. The deleted region\r\n        does not include the isearch word. This is meant to be bound only\r\n        in isearch mode.  The point of this function is that oftentimes\r\n        you want to delete some portion of text, one end of which happens\r\n        to be an active isearch word. The observation to make is that if\r\n        you use isearch a lot to move the cursor around (as you should,\r\n        it is much more efficient than using the arrows), it happens a\r\n        lot that you could just delete the active region between the mark\r\n        and the point, not include the isearch word.\"\r\n        (interactive \"r\")\r\n        (when (not mark-active)\r\n            (error \"Mark is not active\"))\r\n        (let* ((isearch-bounds (list isearch-other-end (point)))\r\n                (ismin (apply 'min isearch-bounds))\r\n                (ismax (apply 'max isearch-bounds))\r\n                )\r\n            (if (< (mark) ismin)\r\n                (kill-region (mark) ismin)\r\n            (if (> (mark) ismax)\r\n                (kill-region ismax (mark))\r\n                (error \"Internal error in isearch kill function.\")))\r\n            (isearch-exit)\r\n            ))\r\n        \r\n        ;; http://www.emacswiki.org/emacs/ZapToISearch\r\n        (defun isearch-exit-other-end (rbeg rend)\r\n        \"Exit isearch, but at the other end of the search string.\r\n        This is useful when followed by an immediate kill.\"\r\n        (interactive \"r\")\r\n        (isearch-exit)\r\n        (goto-char isearch-other-end))\r\n\r\n### Key Bindings<a id=\"sec-5-9-2\" name=\"sec-5-9-2\"></a>\r\n\r\n    (define-key isearch-mode-map (kbd \"C-y\") 'isearch-yank-kill)\r\n    (define-key isearch-mode-map (kbd \"C-M-w\") 'isearch-yank-symbol)\r\n    (define-key isearch-mode-map (kbd \"M-z\") 'zap-to-isearch)\r\n    (define-key isearch-mode-map (kbd \"C-RET\") 'isearch-exit-other-end)\r\n    (define-key isearch-mode-map (kbd \"C-o\") 'isearch-occur)\r\n\r\n## mmm-mode<a id=\"sec-5-10\" name=\"sec-5-10\"></a>\r\n\r\n[Multiple Major Modes](https://github.com/purcell/mmm-mode) is a minor mode for Emacs that allows multiple major modes to coexist in one\r\nbuffer. It is well-suited to editing:\r\n\r\n-   Preprocessed code, e.g. server-side Ruby, Perl or PHP embedded in HTML\r\n-   Code generating code, such as HTML output by CGI scripts\r\n-   Embedded code, such as Javascript in HTML\r\n-   Literate programming: code interspersed with documentation, e.g. Noweb\r\n\r\n    (preamble/require-package 'mmm-mode)\r\n    (require 'mmm-auto)\r\n    ; only enable when `mmm' is required\r\n    (setq mmm-global-mode 'buffers-with-submode-classes)\r\n    (setq mmm-submode-decoration-level 2)\r\n\r\n## recentf<a id=\"sec-5-11\" name=\"sec-5-11\"></a>\r\n\r\n[Recent Files](http://www.emacswiki.org/emacs/RecentFiles) is a minor mode that builds a list of recently opened files. This list is is auto-saved\r\nacross Emacs sessions. You can then access this list through a menu, or keybinding.\r\n\r\n    (require 'recentf)\r\n    (recentf-mode)\r\n    (after 'recentf\r\n      (setq recentf-max-menu-items 25\r\n            recentf-max-saved-items 1000\r\n            recentf-exclude '(\"/tmp/\" \"/ssh:\")))\r\n\r\n## silver-searcher<a id=\"sec-5-12\" name=\"sec-5-12\"></a>\r\n\r\n[The Silver Searcher](https://github.com/ggreer/the_silver_searcher) (`ag`) is an awesome utility, somewhat like `ack`, but faster. This module\r\nallows me to use the power of `ag` inside Emacs' Preamble. The github repository for this package\r\ncan be found at: [Github: The Silver Searcher](https://github.com/Wilfred/ag.el).\r\n\r\n    (when (executable-find \"ag\")\r\n      (preamble/require-packages '(ag wgrep-ag))\r\n      (setq-default ag-highlight-search t))\r\n\r\n## tramp<a id=\"sec-5-13\" name=\"sec-5-13\"></a>\r\n\r\n    (setq tramp-default-method \"ftp\")\r\n\r\n## undo-tree<a id=\"sec-5-14\" name=\"sec-5-14\"></a>\r\n\r\n[UndoTree](http://www.emacswiki.org/emacs/UndoTree) is amazin'. It visually describes your change history for the current buffer in a nice\r\nascii-tree like structure. From there, it is trivially easy to view your changes, and easily\r\nundo/redo according to Emacs' undo structure.\r\n\r\n    (preamble/require-package 'undo-tree)\r\n    (global-undo-tree-mode)\r\n    (diminish 'undo-tree-mode)\r\n\r\n## uniquify<a id=\"sec-5-15\" name=\"sec-5-15\"></a>\r\n\r\n[Uniquify](http://www.emacswiki.org/emacs/uniquify) is a built-in library that makes buffer names unique, when two files with same name are\r\nopen, so as to make them distinguishable.\r\n\r\n    (require 'uniquify)\r\n    \r\n    (after 'uniquify\r\n      (setq uniquify-buffer-name-style 'reverse)\r\n      (setq uniquify-separator \" • \")\r\n      (setq uniquify-after-kill-buffer-p t)\r\n      (setq uniquify-ignore-buffers-re \"^\\\\*\"))\r\n\r\n# Editing<a id=\"sec-6\" name=\"sec-6\"></a>\r\n\r\n## Packages<a id=\"sec-6-1\" name=\"sec-6-1\"></a>\r\n\r\n    (preamble/require-packages\r\n     '( unfill                ; join several lines inside a region/para\r\n        whole-line-or-region  ; kill whole region/line based on if region is active\r\n        mic-paren             ; matching parenthesis even if outside current screen\r\n        pointback             ; per-window memory of buffer-point positions\r\n        multiple-cursors      ; self-explanatory\r\n        ace-jump-mode         ; quickly jump to a character on screen\r\n        page-break-lines      ; display ^L page breaks as tidy horizontal lines\r\n        move-text             ; move text easily up and down\r\n        visual-regexp         ; get visual indications for matched regexp\r\n        highlight-escape-sequences ))\r\n\r\n## Configurations<a id=\"sec-6-2\" name=\"sec-6-2\"></a>\r\n\r\n    ;; settings for `highlight-escape-sequences' package\r\n    (hes-mode)\r\n    \r\n    ;; settings for `page-break-lines' package\r\n    (global-page-break-lines-mode)\r\n    (after 'page-break-lines (diminish 'page-break-lines-mode))\r\n    \r\n    ;; settings for `pointback' package\r\n    (global-pointback-mode)\r\n    (after 'skeleton\r\n      (defadvice skeleton-insert (before disable-pointback activate)\r\n        \"Disable pointback when using skeleton functions like `sgml-tag'.\"\r\n        (when pointback-mode\r\n          (message \"Disabling pointback.\")\r\n          (pointback-mode -1))))\r\n    \r\n    ;; settings for `whole-line-or-region' package\r\n    (whole-line-or-region-mode)\r\n    (after 'whole-line-or-region\r\n      (diminish 'whole-line-or-region-mode)\r\n      (make-variable-buffer-local 'whole-line-or-region-mode))\r\n\r\n## ParEdit<a id=\"sec-6-3\" name=\"sec-6-3\"></a>\r\n\r\n### Activation<a id=\"sec-6-3-1\" name=\"sec-6-3-1\"></a>\r\n\r\n    (preamble/require-packages '(paredit paredit-everywhere))\r\n    (autoload 'enable-paredit-mode \"paredit\")\r\n    (after 'paredit (diminish 'paredit-mode \" Par\"))\r\n    ;; enable some handy paredit functions in all prog modes\r\n    (add-hook 'prog-mode-hook 'paredit-everywhere-mode)\r\n\r\n### Key Bindings<a id=\"sec-6-3-2\" name=\"sec-6-3-2\"></a>\r\n\r\n    (after 'paredit\r\n      (dolist (binding (list (kbd \"C-<left>\") (kbd \"C-<right>\")\r\n                             (kbd \"C-M-<left>\") (kbd \"C-M-<right>\")))\r\n        (define-key paredit-mode-map binding nil))\r\n    \r\n      ;; disable kill-sentence, which is easily confused with the kill-sexp binding, but doesn't\r\n      ;; preserve sexp structure\r\n      (define-key paredit-mode-map [remap kill-sentence] nil)\r\n      (define-key paredit-mode-map [remap backward-kill-sentence] nil))\r\n\r\n### ParEdit inside `mini-buffer`<a id=\"sec-6-3-3\" name=\"sec-6-3-3\"></a>\r\n\r\n    ;; use paredit in the minibuffer\r\n    ;; http://emacsredux.com/blog/2013/04/18/evaluate-emacs-lisp-in-the-minibuffer/\r\n    (defvar paredit-minibuffer-commands '(eval-expression\r\n                                          pp-eval-expression\r\n                                          eval-expression-with-eldoc\r\n                                          ibuffer-do-eval\r\n                                          ibuffer-do-view-and-eval)\r\n      \"Interactive commands for which paredit should be enabled in the minibuffer.\")\r\n    (defun conditionally-enable-paredit-mode ()\r\n      \"Enable paredit during lisp-related minibuffer commands.\"\r\n      (if (memq this-command paredit-minibuffer-commands)\r\n          (enable-paredit-mode)))\r\n    (add-hook 'minibuffer-setup-hook 'conditionally-enable-paredit-mode)\r\n\r\n## Spell Check<a id=\"sec-6-4\" name=\"sec-6-4\"></a>\r\n\r\n    (when *spell-check-support-enabled*\r\n      (require 'ispell)\r\n      (when (executable-find ispell-program-name)\r\n        (require 'init-flyspell)))\r\n\r\n# Org Mode<a id=\"sec-7\" name=\"sec-7\"></a>\r\n\r\n## General Configuration<a id=\"sec-7-1\" name=\"sec-7-1\"></a>\r\n\r\n    ;; set directories used by `org-mode'\r\n    (setq org-directory (expand-file-name \"~/Organizer\"))\r\n    (setq org-archive-location (concat org-directory \"/archives\" ))\r\n    (setq org-special-directory (concat org-directory \"/special\"))\r\n    \r\n    (setq org-global-properties\r\n                '((\"Effort_ALL\". \"0 0:10 0:30 1:00 2:00 3:00 4:00\")))\r\n    \r\n    ;; replace initial/scratch buffer with our primary `.org' file\r\n    (setq initial-buffer-choice (concat org-special-directory \"/start.org\"))\r\n    \r\n    (add-to-list 'auto-mode-alist '(\"\\\\.\\\\(org\\\\|org_archive\\\\|txt\\\\)$\" . org-mode))\r\n    (setq org-log-done t                            ; record information when task is marked as DONE\r\n          org-completion-use-ido t                  ; use ido-completion when possible\r\n          org-edit-timestamp-down-means-later t     ; S-down will increase time in timestamp\r\n          org-fast-tag-selection-single-key 'expert ; fast tag selection\r\n          org-tags-column -100                      ; indent tags to the right\r\n          org-special-ctrl-a/e 't                   ; make them jump to start/end of headings\r\n          org-src-fontify-natively t                ; syntax-highlight source blocks\r\n          org-export-kill-product-buffer-when-displayed t)\r\n    \r\n    (after 'org-mode (setq 'fill-column 100))       ; set column width to 100 for org-mode files\r\n    (add-hook 'org-mode-hook 'turn-on-auto-fill)    ; Turn on `auto-fill'\r\n\r\n## Agenda Setup<a id=\"sec-7-2\" name=\"sec-7-2\"></a>\r\n\r\n      (setq org-agenda-start-on-weekday nil             ; monday as week's start\r\n            org-agenda-span 14                          ; show 2 weeks of agenda, by default\r\n    ;        org-agenda-include-diary 't                 ; include `diary' in agenda\r\n    ;        org-agenda-window-setup 'other-window      ; use `other-window' for agenda\r\n            org-deadline-warning-days 14\r\n            org-agenda-skip-scheduled-if-done 't\r\n            org-habit-show-habits-only-for-today 't\r\n            org-agenda-dim-blocked-tasks 't\r\n            org-agenda-files (quote (\"~/Organizer\"\r\n                                     \"~/Organizer/articles\"\r\n                                     \"~/Organizer/ideas\"\r\n                                     \"~/Organizer/special\"\r\n                                     \"~/Organizer/tidbits\"\r\n                                     \"~/Organizer/work\")))\r\n    \r\n       (add-hook 'org-agenda-mode-hook '(lambda () (hl-line-mode 1)))\r\n    \r\n       (setq org-agenda-custom-commands\r\n               '((\"n\" \"Next Tasks to Work on\" todo \"NEXT\"\r\n                  ((org-agenda-max-entries 5)\r\n                   (org-agenda-sorting-strategy '(priority-up effort-down))))\r\n                 (\"r\" \"Tasks that need refiling\" tags-todo \"REFILE\")\r\n                 (\"i\" \"Important Tasks\" tags-todo \"important\")))\r\n\r\n## OSX Integration<a id=\"sec-7-3\" name=\"sec-7-3\"></a>\r\n\r\nI am using **MacOSX**, and I want my `org-mode` to interact with various applications on it, e.g. I\r\nwant to capture links from my Mac applications and add them to `org-mode`, as well as with\r\n`iCal`. Moreover, I often require to put a file-system subtree inside my `org-mode` documents.\r\n\r\n    (preamble/require-package 'org-fstree)\r\n    (when *is-mac*\r\n      (preamble/require-packages '(org-mac-link org-mac-iCal))\r\n      (autoload 'omlg-grab-link \"org-mac-link\"))\r\n\r\n## Refile / Archives<a id=\"sec-7-4\" name=\"sec-7-4\"></a>\r\n\r\nI have defined some configuration to make [refiling](http://www.gnu.org/software/emacs/manual/html_node/org/Capture-_002d-Refile-_002d-Archive.html) easier.\r\n\r\n    ; Refile targets include this file and any file contributing to the agenda - up to 2 levels deep\r\n    (setq org-refile-targets (quote ((nil :maxlevel . 3) (org-agenda-files :maxlevel . 3))))\r\n    \r\n    ; Use full outline paths for refile targets - we file directly with IDO\r\n    (setq org-refile-use-outline-path t)\r\n    \r\n    ; Targets complete directly with IDO\r\n    (setq org-outline-path-complete-in-steps nil)\r\n    \r\n    ; Allow refile to create parent tasks with confirmation\r\n    (setq org-refile-allow-creating-parent-nodes (quote confirm))\r\n    \r\n    ; Use IDO for org-completion\r\n    (setq org-completion-use-ido t)\r\n    \r\n    ; Use the current window for indirect buffer display\r\n    (setq org-indirect-buffer-display 'current-window)\r\n    \r\n    ;;;; Refile settings\r\n    ; Exclude DONE state tasks from refile targets\r\n    (defun preamble/verify-refile-target ()\r\n        \"Exclude todo keywords with a done state from refile targets\"\r\n          (not (member (nth 2 (org-heading-components)) org-done-keywords)))\r\n    \r\n    (setq org-refile-target-verify-function 'preamble/verify-refile-target)\r\n    \r\n    ; timestamp refiling\r\n    (setq org-log-refile 'time)\r\n    \r\n    ; update counters\r\n    (add-hook 'org-after-refile-insert-hook 'org-update-parent-todo-statistics)\r\n\r\n## TODO Keywords / Tagging<a id=\"sec-7-5\" name=\"sec-7-5\"></a>\r\n\r\nI have set `org-mode` to log the time when a task is repeated (for habit-tracking) and when it is\r\nrescheduled. Furthermore, I would like to take a quick note, when I am changing the deadline for a\r\ntask. I am using custom workflows for task management:\r\n\r\n-   **TODO**: a task.\r\n-   **STARTED**: when I have started working on a **TODO**.\r\n-   **NEXT**: **TODOs** I want to work on, next. Possibly, a next action in a project.\r\n-   **REVIEW**: tasks that I have completed, but I need to check if there is something I need to check\r\n    or share from the experience of this task. Furthermore, it is a persistent tag for some of the\r\n    review processes, I use in my workflow, e.g. reviewing this emacs setup once a month.\r\n-   **DONE**: a completed task, which will be either archived using org-archive or deleted within 7 days.\r\n-   **ARCHIVE**: a completed task that I will like to keep for a longer time.\r\n\r\nBeing a developer, I need an additional set of workflow, which tackles bug-fixing scenario.\r\n\r\nA last set of todo workflow involves keywords such as **WAITING**, **HOLD**, **SOMEDAY**, **CANCELLED**,\r\netc. and give a special meaning to the task.\r\n\r\n-   **WAITING**: a part of the task was delegated and can not be continued for this reason.\r\n-   **HOLD**: tasks that I have started working on, but can not continue for some reason.\r\n-   **SOMEDAY**: tasks I would like to finish in future, but have no specific deadlines.\r\n-   **CANCELLED**: tasks which have been cancelled for some reason.\r\n\r\nFor me, a project is any task which has sub-tasks. Easy for me to remember and less burden classifying\r\nwhat constitutes a project and what not.\r\n\r\n    (setq org-log-repeat 'time\r\n          org-log-redeadline 'note\r\n          org-log-reschedule 'time\r\n          org-use-fast-todo-selection 't\r\n          org-enforce-todo-dependencies 't\r\n          org-enforce-todo-checkbox-dependencies 't\r\n          org-treat-S-cursor-todo-selection-as-state-change 'nil\r\n          org-hierarchical-todo-statistics 'nil)\r\n    \r\n    (setq org-enable-priority-commands t)\r\n    (setq org-highest-priority ?A)\r\n    (setq org-default-priority ?E)\r\n    (setq org-lowest-priority ?E)\r\n    \r\n    (setq org-todo-keywords\r\n          (quote ((sequence \"TODO(t)\" \"STARTED(s!)\" \"NEXT(n)\" \"REVIEW(r@/!)\" \"|\" \"DONE(d!)\" \"ARCHIVED(a)\")\r\n                  (sequence \"REPORT(R!)\" \"BUG(b@/!)\" \"KNOWNCAUSE(k@/!)\" \"|\" \"FIXED(f@/!)\")\r\n                  (sequence \"WAITING(w@/!)\" \"HOLD(h@/!)\" \"SOMEDAY(S)\" \"|\" \"CANCELLED(c@/!)\" \"DUPE(D)\"))))\r\n    \r\n    ;; Setting Colours (faces) for todo states to give clearer view of work\r\n    (setq org-todo-keyword-faces\r\n      '((\"TODO\" . org-warning)\r\n        (\"STARTED\" . \"yellow\")\r\n        (\"NEXT\" . \"magenta\")\r\n        (\"REVIEW\" . \"orange\")\r\n        (\"DONE\" . \"green\")\r\n        (\"ARCHIVED\" . \"blue\")\r\n        (\"WAITING\" . \"cyan\")\r\n        (\"HOLD\" . \"cyan\")\r\n        (\"SOMEDAY\" . \"grey\")\r\n        (\"CANCELLED\" . outline-9)))\r\n    \r\n    ; position the habit graph on the agenda to the right of the default\r\n    (setq org-habit-graph-column 50)\r\n    (run-at-time \"10:00\" 86400 '(lambda () (setq org-habit-show-habits t)))\r\n    \r\n    ;; configure most used tags for fast access\r\n    ;; (setq org-tag-alist '((\"@work\" . ?w) (\"@home\" . ?h) (\"laptop\" . ?l) (:newline . nil)\r\n    ;;                       (\"@personal\" . ?p)\r\n    ;;                       (\"relationships\" . ?r) (\"introspection\" . ?i) (:newline . nil)\r\n    ;;                       (\"@devesh\" . ?d)\r\n    ;;                       (\"code\" . ?c) (\"emacs\" . ?e) (\"zsh\" . ?z)     (:newline . nil)))\r\n\r\n## Clocking<a id=\"sec-7-6\" name=\"sec-7-6\"></a>\r\n\r\n    ;; save the running clock and all clock history when exiting Emacs, load it on startup\r\n    (setq org-clock-persist t\r\n          org-clock-in-resume t\r\n          org-clock-persistence-insinuate t\r\n          org-clock-in-switch-to-state \"STARTED\"  ;; change task state to STARTED when clocking in\r\n          org-clock-into-drawer t  ;; save clock data and notes in the LOGBOOK drawer\r\n          org-clock-out-remove-zero-time-clocks t  ;; removes clocked tasks with 0:00 duration\r\n          )\r\n    ;; show the clocked-in task - if any - in the header line\r\n    (defun preamble/show-org-clock-in-header-line ()\r\n      (setq-default header-line-format '((\" \" org-mode-line-string \" \"))))\r\n    (defun preamble/hide-org-clock-from-header-line ()\r\n      (setq-default header-line-format nil))\r\n    \r\n    (add-hook 'org-clock-in-hook 'preamble/show-org-clock-in-header-line)\r\n    (add-hook 'org-clock-out-hook 'preamble/hide-org-clock-from-header-line)\r\n    (add-hook 'org-clock-cancel-hook 'preamble/hide-org-clock-from-header-line)\r\n\r\n## Captures<a id=\"sec-7-7\" name=\"sec-7-7\"></a>\r\n\r\n    ;; set files used by `org-capture'\r\n    (setq org-journal-file (concat org-special-directory \"/diary.org\"))\r\n    (setq org-default-notes-file (concat org-special-directory \"/refile.org\"))\r\n    (setq org-default-tasks-file (concat org-special-directory \"/tasks.org\"))\r\n    (defun org-journal-entry-time() (format-time-string \"%I:%M %p\"))\r\n    \r\n    ;; customizations for `org-capture'\r\n    (setq org-capture-templates\r\n          '((\"t\" \"Todo\" entry (file+headline org-default-tasks-file \"Captured\")\r\n             \"* TODO %?\\n%i\\n\")\r\n            (\"n\" \"Note\" entry (file+datetree org-default-notes-file \"Notes\")\r\n             \"* %? :NOTE:\\n%U\\n%a\\n%?\" :clock-in t :clock-resume t)\r\n            (\"j\" \"Journal\" entry (file+datetree org-journal-file \"Journal\")\r\n             \"* at %(org-journal-entry-time) :crypt:\\n  %U\\n  %?\" :clock-in t :clock-resume t)\r\n            (\"l\" \"Link\" plain (file org-default-notes-file \"Links\")\r\n             \"- %?\\n %x\\n\")\r\n            (\"r\" \"respond\" entry (file org-default-notes-file)\r\n             \"* NEXT Respond to %:from on %:subject\\nSCHEDULED: %t\\n%U\\n%a\\n\" :clock-in t :clock-resume t :immediate-finish t)\r\n            (\"w\" \"org-protocol\" entry (file org-default-notes-file)\r\n             \"* TODO Review %c\\n%U\\n\" :immediate-finish t)\r\n            (\"m\" \"Meeting\" entry (file org-default-notes-file)\r\n             \"* MEETING with %? :MEETING:\\n%U\" :clock-in t :clock-resume t)\r\n            (\"p\" \"Phone call\" entry (file org-default-notes-file)\r\n             \"* PHONE %? :PHONE:\\n%U\" :clock-in t :clock-resume t)\r\n            (\"h\" \"Habit\" entry (file+headline org-default-tasks-file \"Captured\")\r\n             \"* NEXT %?\\n%U\\n%a\\nSCHEDULED: %(format-time-string \\\"<%Y-%m-%d %a .+1d/3d>\\\")\\n:PROPERTIES:\\n:STYLE: habit\\n:REPEAT_TO_STATE: NEXT\\n:END:\\n\")))\r\n\r\n## Encryption<a id=\"sec-7-8\" name=\"sec-7-8\"></a>\r\n\r\n    ;;; file encryption\r\n    (setq epa-file-inhibit-auto-save 't)\r\n    \r\n    ;;; encryption sections of a file\r\n    (require 'org-crypt)\r\n    (org-crypt-use-before-save-magic)\r\n    (setq org-tags-exclude-from-inheritance (quote (\"crypt\")))\r\n    ;; GPG key to use for encryption\r\n    ;; Either the Key ID or set to nil to use symmetric encryption.\r\n    (setq org-crypt-key \"me@nikhgupta.com\")\r\n    (setq org-crypt-disable-auto-save 'encrypt)\r\n\r\n## Key Bindings<a id=\"sec-7-9\" name=\"sec-7-9\"></a>\r\n\r\n    (after 'org\r\n      (define-key org-mode-map (kbd \"C-M-<up>\") 'org-up-element)\r\n      (when *is-mac*\r\n        (define-key org-mode-map (kbd \"M-h\") nil)\r\n        (define-key org-mode-map (kbd \"C-c g\") 'omlg-grab-link)))\r\n    \r\n    ;; Standard key bindings\r\n    (global-set-key (kbd \"C-c l\") 'org-store-link)\r\n    (global-set-key (kbd \"C-c a\") 'org-agenda)\r\n    (global-set-key (kbd \"C-c b\") 'org-iswitchb)\r\n    (global-set-key (kbd \"C-c c\") 'org-capture)\r\n\r\n# Programming<a id=\"sec-8\" name=\"sec-8\"></a>\r\n\r\n## Ruby Group<a id=\"sec-8-1\" name=\"sec-8-1\"></a>\r\n\r\n### Packages<a id=\"sec-8-1-1\" name=\"sec-8-1-1\"></a>\r\n\r\n    (preamble/require-packages '(ruby-mode\r\n                                 ruby-hash-syntax\r\n                                 inf-ruby\r\n                                 robe\r\n                                 ruby-compilation\r\n                                 yari\r\n                                 yaml-mode\r\n                                 tagedit\r\n                                 rinari))\r\n\r\n### Registered File Patterns<a id=\"sec-8-1-2\" name=\"sec-8-1-2\"></a>\r\n\r\n    ;; files recognized by ruby mode\r\n    (add-to-list 'auto-mode-alist '(\"Rakefile\\\\'\" \"\\\\.rake\\\\'\" \"\\\\.rxml\\\\'\"\r\n                                    \"\\\\.rjs\\\\'\" \".irbrc\\\\'\" \"\\\\.builder\\\\'\" \"\\\\.ru\\\\'\"\r\n                                    \"\\\\.gemspec\\\\'\" \"Gemfile\\\\'\" \"Kirkfile\\\\'\" . 'ruby-mode))\r\n\r\n### Configuration<a id=\"sec-8-1-3\" name=\"sec-8-1-3\"></a>\r\n\r\n    (defalias 'ri 'yari)\r\n    (setq ruby-use-encoding-map nil)\r\n    \r\n    (after 'ruby-mode\r\n      ;; stupidly the non-bundled ruby-mode isn't a derived mode of\r\n      ;; prog-mode: we run the latter's hooks anyway in that case.\r\n      (add-hook 'ruby-mode-hook\r\n                '(lambda () (unless (derived-mode-p 'prog-mode) (run-hooks 'prog-mode-hook)))))\r\n    \r\n    ;;; robe: Code navigation, documentation and completion for Ruby\r\n    (after 'ruby-mode (add-hook 'ruby-mode-hook 'robe-mode))\r\n    (after 'robe (add-hook 'robe-mode-hook\r\n                           (lambda ()\r\n                             (add-to-list 'ac-sources 'ac-source-robe)\r\n                             (set-auto-complete-as-completion-at-point-function))))\r\n\r\n### Rails<a id=\"sec-8-1-4\" name=\"sec-8-1-4\"></a>\r\n\r\n    (after 'rinari (diminish 'rinari-minor-mode \"Rin\"))\r\n    (global-rinari-mode)\r\n    \r\n    (defun update-rails-ctags ()\r\n      (interactive)\r\n      (let ((default-directory (or (rinari-root) default-directory)))\r\n        (shell-command (concat \"ctags -a -e -f \" rinari-tags-file-name\r\n                               \" --tag-relative -R app lib vendor test\"))))\r\n\r\n### Embedded Ruby (ERB) using `mmm-mode`<a id=\"sec-8-1-5\" name=\"sec-8-1-5\"></a>\r\n\r\n    (require 'derived)\r\n    (defun preamble/ensure-mmm-erb-loaded () (require 'mmm-erb))\r\n    (defun preamble/set-up-mode-for-erb (mode)\r\n      (add-hook (derived-mode-hook-name mode) 'preamble/ensure-mmm-erb-loaded)\r\n      (mmm-add-mode-ext-class mode \"\\\\.erb\\\\'\" 'erb))\r\n    \r\n    (dolist (mode '(html-mode html-erb-mode nxml-mode))\r\n      (progn\r\n        (preamble/set-up-mode-for-erb mode)\r\n        (mmm-add-mode-ext-class mode \"\\\\.r?html\\\\(\\\\.erb\\\\)?\\\\'\" 'html-js)\r\n        (mmm-add-mode-ext-class mode \"\\\\.r?html\\\\(\\\\.erb\\\\)?\\\\'\" 'html-css)))\r\n    \r\n    (mapc 'preamble/set-up-mode-for-erb\r\n          '(coffee-mode js-mode js2-mode js3-mode markdown-mode textile-mode))\r\n    \r\n    (add-to-list 'auto-mode-alist '(\"\\\\.rhtml\\\\'\" \"\\\\.html\\\\.erb\\\\'\" . 'html-erb-mode))\r\n    (add-to-list 'auto-mode-alist '(\"\\\\.jst\\\\.ejs\\\\'\"  . html-erb-mode))\r\n    (mmm-add-mode-ext-class 'yaml-mode \"\\\\.yaml\\\\'\" 'erb)\r\n    (mmm-add-mode-ext-class 'html-erb-mode \"\\\\.jst\\\\.ejs\\\\'\" 'ejs)\r\n    \r\n    (dolist (mode (list 'js-mode 'js2-mode 'js3-mode))\r\n      (mmm-add-mode-ext-class mode \"\\\\.js\\\\.erb\\\\'\" 'erb))\r\n\r\n### Key Bindings<a id=\"sec-8-1-6\" name=\"sec-8-1-6\"></a>\r\n\r\n    (after 'ruby-mode\r\n      (define-key ruby-mode-map (kbd \"RET\") 'reindent-then-newline-and-indent)\r\n      (define-key ruby-mode-map (kbd \"TAB\") 'indent-for-tab-command))\r\n    \r\n    ;; ruby compilation\r\n    (let ((m ruby-mode-map))\r\n      (define-key m [S-f7] 'ruby-compilation-this-buffer)\r\n      (define-key m [f7] 'ruby-compilation-this-test)\r\n      (define-key m [f6] 'recompile))\r\n\r\n## PHP Group<a id=\"sec-8-2\" name=\"sec-8-2\"></a>\r\n\r\n    (preamble/require-packages '(php-mode smarty-mode))\r\n\r\n## Javascript Group<a id=\"sec-8-3\" name=\"sec-8-3\"></a>\r\n\r\n### Packages and Configuration<a id=\"sec-8-3-1\" name=\"sec-8-3-1\"></a>\r\n\r\n    (preamble/require-packages '( json js2-mode ac-js2 rainbow-delimiters coffee-mode))\r\n    \r\n    (defvar preferred-javascript-indent-level 2)\r\n    (defcustom preferred-javascript-mode\r\n      (first (remove-if-not #'fboundp '(js2-mode js-mode)))\r\n      \"Javascript mode to use for .js files.\"\r\n      :type 'symbol\r\n      :group 'programming\r\n      :options '(js2-mode js-mode))\r\n    \r\n    ;; json\r\n    (add-to-list 'auto-mode-alist '(\"\\\\.json\\\\'\" . js-mode))\r\n    ;; js-mode\r\n    (setq js-indent-level preferred-javascript-indent-level)\r\n    (setq javascript-indent-level preferred-javascript-indent-level)\r\n    ;; node interpreter\r\n    (add-to-list 'interpreter-mode-alist (cons \"node\" preferred-javascript-mode))\r\n    ;; javascript (even inside erb)\r\n    (setq auto-mode-alist (cons `(\"\\\\.js\\\\(\\\\.erb\\\\)?\\\\'\" . ,preferred-javascript-mode)\r\n                                (loop for entry in auto-mode-alist\r\n                                      unless (eq preferred-javascript-mode (cdr entry))\r\n                                      collect entry)))\r\n\r\n### js2-mode<a id=\"sec-8-3-2\" name=\"sec-8-3-2\"></a>\r\n\r\n    (setq js2-use-font-lock-faces t\r\n          js2-mode-must-byte-compile nil\r\n          js2-basic-offset preferred-javascript-indent-level\r\n          js2-indent-on-enter-key t\r\n          js2-auto-indent-p t\r\n          js2-bounce-indent-p nil)\r\n    (after 'js2-mode\r\n      (add-hook 'js2-mode-hook '(lambda() (setq mode-name \"JS2\")))\r\n      (js2-imenu-extras-setup))\r\n\r\n### CoffeeScript<a id=\"sec-8-3-3\" name=\"sec-8-3-3\"></a>\r\n\r\n    (after 'coffee-mode\r\n      (setq coffee-js-mode preferred-javascript-mode\r\n            coffee-tab-width preferred-javascript-indent-level))\r\n    \r\n    (add-to-list 'auto-mode-alist '(\"\\\\.coffee\\\\.erb\\\\'\" . coffee-mode))\r\n\r\n## Text Group<a id=\"sec-8-4\" name=\"sec-8-4\"></a>\r\n\r\n### Textile<a id=\"sec-8-4-1\" name=\"sec-8-4-1\"></a>\r\n\r\n    (preamble/require-package 'textile-mode)\r\n    \r\n    (autoload 'textile-mode \"textile-mode\" \"Mode for editing Textile documents\" t)\r\n    (add-to-list 'auto-mode-alist '(\"\\\\.textile\\\\'\" . textile-mode))\r\n\r\n### Markdown<a id=\"sec-8-4-2\" name=\"sec-8-4-2\"></a>\r\n\r\n    (preamble/require-package 'markdown-mode)\r\n    \r\n    (add-to-list 'auto-mode-alist '(\"\\\\.\\\\(md\\\\|markdown\\\\)\\\\'\" . markdown-mode))\r\n\r\n## XML Group<a id=\"sec-8-5\" name=\"sec-8-5\"></a>\r\n\r\n### Configuration<a id=\"sec-8-5-1\" name=\"sec-8-5-1\"></a>\r\n\r\n    (add-to-list 'auto-mode-alist '(\"\\\\.\\\\(xml\\\\|xsd\\\\|sch\\\\|rng\\\\|xslt\\\\|svg\\\\|rss\\\\|gpx\\\\|tcx\\\\)\\\\'\" . nxml-mode))\r\n    ; generic xml-mode\r\n    (fset 'xml-mode 'nxml-mode)\r\n    (setq magic-mode-alist (cons '(\"<\\\\?xml \" . nxml-mode) magic-mode-alist))\r\n    (add-hook 'nxml-mode-hook\r\n              '(lambda () (set (make-local-variable 'ido-use-filename-at-point) nil)))\r\n    (setq nxml-slash-auto-complete-flag t)\r\n\r\n### Pretty Format XML Markup<a id=\"sec-8-5-2\" name=\"sec-8-5-2\"></a>\r\n\r\n    ;; see: http://sinewalker.wordpress.com/2008/06/26/pretty-printing-xml-with-emacs-nxml-mode/\r\n    (defun pp-xml-region (begin end)\r\n      \"Pretty format XML markup in region. The function inserts\r\n        linebreaks to separate tags that have nothing but whitespace\r\n        between them.  It then indents the markup by using nxml's\r\n        indentation rules.\"\r\n      (interactive \"r\")\r\n      (save-excursion\r\n        (nxml-mode)\r\n        (goto-char begin)\r\n        (while (search-forward-regexp \"\\>[ \\\\t]*\\<\" nil t)\r\n          (backward-char) (insert \"\\n\"))\r\n        (indent-region begin end)))\r\n\r\n### TIDY integration<a id=\"sec-8-5-3\" name=\"sec-8-5-3\"></a>\r\n\r\n    (preamble/require-package 'tidy)\r\n    (add-hook 'nxml-mode-hook (lambda () (tidy-build-menu nxml-mode-map)))\r\n    (add-hook 'html-mode-hook (lambda () (tidy-build-menu html-mode-map)))\r\n\r\n## Design Group<a id=\"sec-8-6\" name=\"sec-8-6\"></a>\r\n\r\n### Configuration<a id=\"sec-8-6-1\" name=\"sec-8-6-1\"></a>\r\n\r\n    (preamble/require-packages '(css-eldoc haml-mode htmlize))\r\n    (require 'rainbow-mode)\r\n    \r\n    ;;; colourise hex colors\r\n    (dolist (hook '(css-mode-hook html-mode-hook sass-mode-hook)) (add-hook hook 'rainbow-mode))\r\n    \r\n    ;; use eldoc for syntax hints\r\n    (autoload 'turn-on-css-eldoc \"css-eldoc\")\r\n    (add-hook 'css-mode-hook 'turn-on-css-eldoc)\r\n    \r\n    ;; to enable Skewer mode, check:\r\n    ;; https://github.com/purcell/emacs.d/blob/master/init-css.el\r\n    \r\n    ;; SASS, SCSS, and Less\r\n    (preamble/require-packages '(sass-mode scss-mode less-css-mode))\r\n    (setq-default scss-compile-at-save nil)\r\n    \r\n    ;;; auto-complete CSS keywords\r\n    (after 'auto-complete\r\n      (dolist (hook '(css-mode-hook sass-mode-hook scss-mode-hook))\r\n        (add-hook hook 'ac-css-mode-setup)))\r\n\r\n### CSS embedded in HTML<a id=\"sec-8-6-2\" name=\"sec-8-6-2\"></a>\r\n\r\n    (after 'mmm-vars\r\n      (mmm-add-group\r\n       'html-css\r\n       '((css-cdata\r\n          :submode css-mode\r\n          :face mmm-code-submode-face\r\n          :front \"<style[^>]*>[ \\t\\n]*\\\\(//\\\\)?<!\\\\[CDATA\\\\[[ \\t]*\\n?\"\r\n          :back \"[ \\t]*\\\\(//\\\\)?]]>[ \\t\\n]*</style>\"\r\n          :insert ((?j js-tag nil @ \"<style type=\\\"text/css\\\">\"\r\n                       @ \"\\n\" _ \"\\n\" @ \"</script>\" @)))\r\n         (css\r\n          :submode css-mode\r\n          :face mmm-code-submode-face\r\n          :front \"<style[^>]*>[ \\t]*\\n?\"\r\n          :back \"[ \\t]*</style>\"\r\n          :insert ((?j js-tag nil @ \"<style type=\\\"text/css\\\">\"\r\n                       @ \"\\n\" _ \"\\n\" @ \"</style>\" @)))\r\n         (css-inline\r\n          :submode css-mode\r\n          :face mmm-code-submode-face\r\n          :front \"style=\\\"\"\r\n          :back \"\\\"\"))))\r\n\r\n## Lisp Group<a id=\"sec-8-7\" name=\"sec-8-7\"></a>\r\n\r\n### Packages<a id=\"sec-8-7-1\" name=\"sec-8-7-1\"></a>\r\n\r\n    (preamble/require-packages '(elisp-slime-nav     ; use M-.|M- to jump-in and out of definitions\r\n                                 lively              ; interactively updated text: http://git.io/gbjLUw\r\n                                 pretty-mode         ; redisplay parts of buffer as pretty symbols\r\n                                 auto-compile        ; automatically compile emacs-lisp libraries\r\n                                 hl-sexp             ; highlight current `sexp'\r\n                                 rainbow-delimiters  ; colorize parenthesis\r\n                                 redshank            ; common-lisp editing extensions\r\n                                 macrostep))         ; interactive macro expension inside eLisp\r\n\r\n### Activation<a id=\"sec-8-7-2\" name=\"sec-8-7-2\"></a>\r\n\r\n    (global-pretty-mode)\r\n    (after 'redshank (diminish 'redshank-mode))\r\n    \r\n    ;; activate `emacs-slime-nav'\r\n    (dolist (hook '(emacs-lisp-mode-hook ielm-mode-hook))\r\n      (add-hook hook 'turn-on-elisp-slime-nav-mode))\r\n    \r\n    ;; `hl-sexp': prevent flickery behaviour as `hl-sexp-mode' unhighlights before each command\r\n    (after 'hl-sexp\r\n      (defadvice hl-sexp-mode (after unflicker (&optional turn-on) activate)\r\n        (when turn-on\r\n          (remove-hook 'pre-command-hook #'hl-sexp-unhighlight))))\r\n\r\n### Emacs Lisp<a id=\"sec-8-7-3\" name=\"sec-8-7-3\"></a>\r\n\r\n    (require 'derived)\r\n    (defun preamble/emacs-lisp-setup ()\r\n      \"Enable features useful when working with elisp.\"\r\n      (elisp-slime-nav-mode)\r\n      (ac-emacs-lisp-mode-setup))\r\n    \r\n    (defconst preamble/elispy-modes\r\n      '(emacs-lisp-mode ielm-mode)\r\n      \"Major modes relating to elisp.\")\r\n    \r\n    (dolist (hook (mapcar #'derived-mode-hook-name preamble/elispy-modes))\r\n      (add-hook hook 'preamble/emacs-lisp-setup))\r\n    \r\n    (add-to-list 'auto-mode-alist '(\"\\\\.emacs-project\\\\'\" . emacs-lisp-mode))\r\n    (add-to-list 'auto-mode-alist '(\"archive-contents\\\\'\" . emacs-lisp-mode))\r\n\r\n1.  Key Bindings\r\n\r\n        (define-key emacs-lisp-mode-map (kbd \"C-x C-a\") 'pp-macroexpand-last-sexp)\r\n        (define-key emacs-lisp-mode-map (kbd \"C-x C-e\") 'pp-eval-last-sexp)\r\n\r\n2.  AutoCompiled Emacs Lisp Buffers\r\n\r\n        (auto-compile-on-save-mode)\r\n        (auto-compile-on-load-mode)\r\n\r\n### Lisp<a id=\"sec-8-7-4\" name=\"sec-8-7-4\"></a>\r\n\r\n    (require 'derived)\r\n    (defun preamble/lisp-setup ()\r\n      \"Enable features useful in any Lisp mode.\"\r\n      (rainbow-delimiters-mode)\r\n      (enable-paredit-mode)\r\n      (turn-on-eldoc-mode)\r\n      (redshank-mode)\r\n      (hl-sexp-mode))\r\n    \r\n    (defconst preamble/lispy-modes\r\n      (append preamble/elispy-modes\r\n              '(lisp-mode inferior-lisp-mode lisp-interaction-mode))\r\n      \"All lispy major modes.\")\r\n    \r\n    (dolist (hook (mapcar #'derived-mode-hook-name preamble/lispy-modes))\r\n      (add-hook hook 'preamble/lisp-setup))\r\n    \r\n    (defun preamble/maybe-check-parens ()\r\n      \"Run `check-parens' if this is a lispy mode.\"\r\n      (when (memq major-mode preamble/lispy-modes)\r\n        (check-parens)))\r\n    \r\n    (add-hook 'after-save-hook #'preamble/maybe-check-parens)\r\n\r\n## Other Languages<a id=\"sec-8-8\" name=\"sec-8-8\"></a>\r\n\r\n    (preamble/require-packages '( crontab-mode\r\n                                  csv-mode\r\n                                  csv-nav\r\n                                  sql-indent ))\r\n    \r\n    ;; crontab\r\n    (add-to-list 'auto-mode-alist '(\"\\\\.?cron\\\\(tab\\\\)?\\\\'\" . 'crontab-mode))\r\n    \r\n    ;; csv\r\n    (add-to-list 'auto-mode-alist '(\"\\\\.[Cc][Ss][Vv]\\\\'\" . 'csv_mode))\r\n    (setq csv-separators '(\",\" \";\" \"|\" \" \"))\r\n\r\n### SQL<a id=\"sec-8-8-1\" name=\"sec-8-8-1\"></a>\r\n\r\n    (after 'sql\r\n      (require 'sql-indent)\r\n      (when (package-installed-p 'dash-at-point)\r\n        (defun preamble/maybe-set-dash-db-docset ()\r\n          (when (eq sql-product 'postgres)\r\n            (setq dash-at-point-docset \"psql\")))\r\n    \r\n        (add-hook 'sql-mode-hook 'preamble/maybe-set-dash-db-docset)\r\n        (add-hook 'sql-interactive-mode-hook 'preamble/maybe-set-dash-db-docset)\r\n        (defadvice sql-set-product (after set-dash-docset activate)\r\n          (preamble/maybe-set-dash-db-docset))))\r\n    \r\n    (setq-default sql-input-ring-file-name\r\n                  (expand-file-name \".sqli_history\" preamble-dir))\r\n\r\n# Session Management<a id=\"sec-9\" name=\"sec-9\"></a>\r\n\r\n## Configuration<a id=\"sec-9-1\" name=\"sec-9-1\"></a>\r\n\r\n      ;; save a list of open files in ~/.emacs.d/.emacs.desktop\r\n    ;  (setq desktop-path (list preamble-dir))\r\n    ;  (desktop-save-mode)\r\n    \r\n      ;; display time taken in restoring desktop\r\n      (defadvice desktop-read (around time-restore activate)\r\n        (let ((start-time (current-time)))\r\n          (prog1\r\n              ad-do-it\r\n            (message \"Desktop restored in %.2fms\"\r\n                     (preamble/time-subtract-millis (current-time) start-time)))))\r\n    \r\n      ;; display time taken in restoring a buffer\r\n      (defadvice desktop-create-buffer (around time-create activate)\r\n        (let ((start-time (current-time))\r\n              (filename (ad-get-arg 1)))\r\n          (prog1\r\n              ad-do-it\r\n            (message \"Desktop: took me %.2fms to restore %s\"\r\n                     (preamble/time-subtract-millis (current-time) start-time)\r\n                     (when filename\r\n                       (abbreviate-file-name filename))))))\r\n\r\n## Restore Session Variables<a id=\"sec-9-2\" name=\"sec-9-2\"></a>\r\n\r\n    ;; restore histories and registers after saving\r\n    (preamble/require-package 'session)\r\n    \r\n    (setq session-save-file (expand-file-name \".session\" preamble-dir))\r\n    (add-hook 'after-init-hook 'session-initialize)\r\n    \r\n    ;; save a bunch of variables to the desktop file\r\n    ;; for lists specify the len of the maximal saved data also\r\n    (setq desktop-globals-to-save\r\n          (append '((extended-command-history . 30)\r\n                    (file-name-history        . 100)\r\n                    (ido-last-directory-list  . 100)\r\n                    (ido-work-directory-list  . 100)\r\n                    (ido-work-file-list       . 100)\r\n                    (grep-history             . 30)\r\n                    (compile-history          . 30)\r\n                    (minibuffer-history       . 50)\r\n                    (query-replace-history    . 60)\r\n                    (read-expression-history  . 60)\r\n                    (regexp-history           . 60)\r\n                    (regexp-search-ring       . 20)\r\n                    (search-ring              . 20)\r\n                    (comint-input-ring        . 50)\r\n                    (shell-command-history    . 50)\r\n                    desktop-missing-file-warning\r\n                    tags-file-name\r\n                    register-alist)))\r\n\r\n## Restore Frame<a id=\"sec-9-3\" name=\"sec-9-3\"></a>\r\n\r\n    (when (eval-when-compile (string< emacs-version \"24.3.50\"))\r\n      (unless (boundp 'desktop-restore-frames)\r\n        (preamble/require-package 'frame-restore)\r\n        (frame-restore)))\r\n\r\n# Version Management<a id=\"sec-10\" name=\"sec-10\"></a>\r\n\r\nVersion management is the heart of my projects, in particular, [git](http://git-scm.com). This section defines various\r\nsettings so as to allow me to version control my projects from within Emacs' Preamble.\r\n\r\n## Related Modules<a id=\"sec-10-1\" name=\"sec-10-1\"></a>\r\n\r\n    (preamble/require-packages\r\n     '(  magit             ;; awesome git interface inside Emacs\r\n         git-blame         ;; emacs frontend for `git-blame' tool\r\n         gitignore-mode    ;; major mode for gitignore\r\n         gitconfig-mode    ;; major mode for gitconfig\r\n         git-commit-mode   ;; major mode for git commit\r\n         git-rebase-mode   ;; major mode for git rebase\r\n         git-messenger     ;; display why a line was changed as per git commits\r\n         git-gutter-fringe ;; display git status of lines in gutter\r\n         yagist            ;; gist management\r\n         github-browse-file ;; view the file we're editing in Github\r\n         bug-reference-github ;; Automatically set bug-reference-url-format and enable\r\n         ;; bug-reference-prog-mode buffers from Github repositories.\r\n         ))\r\n    \r\n    ;; activate `bug-reference-github' in programming mode\r\n    (after 'bug-reference-github\r\n      (add-hook 'prog-mode-hook 'bug-reference-prog-mode))\r\n\r\n## Magit Configuration<a id=\"sec-10-2\" name=\"sec-10-2\"></a>\r\n\r\nNow, all I need is to setup [magit](https://github.com/magit/magit) as I intend it to perform inside my workflow.\r\n\r\n    (setq-default magit-save-some-buffers nil\r\n                  magit-process-popup-time 10\r\n                  magit-diff-refine-hunk t\r\n                  magit-completing-read-function 'magit-ido-completing-read)\r\n    \r\n    (after 'magit\r\n      ;; don't let magit-status mess up window configurations\r\n      ;; http://whattheemacsd.com/setup-magit.el-01.html\r\n      (defadvice magit-status (around magit-fullscreen activate)\r\n        (window-configuration-to-register :magit-fullscreen)\r\n        ad-do-it\r\n        (delete-other-windows))\r\n    \r\n      (defadvice magit-quit-window (around magit-restore-screen activate)\r\n        ad-do-it\r\n        (jump-to-register :magit-fullscreen)))\r\n    \r\n    ;;; when we start working on git-backed files, use git-wip if available\r\n    (after 'vc-git\r\n      (global-magit-wip-save-mode)\r\n      (diminish 'magit-wip-save-mode))\r\n\r\n# OSX Specific Configuration<a id=\"sec-11\" name=\"sec-11\"></a>\r\n\r\nWhen working on my Macbook Pro '13, I prefer my keys to work a bit differently, and want some\r\nopitons to behave differently. The following code summarises so:\r\n\r\n    (when *is-mac*\r\n      (setq-default locate-command \"mdfind\")\r\n      (setq mac-command-modifier 'meta)\r\n      (setq mac-option-modifier 'none)\r\n      (setq default-input-method \"MacOSX\")\r\n      ;; make mouse wheel / trackpad scrolling less jerky\r\n      (setq mouse-wheel-scroll-amount '(0.001)))\r\n    \r\n    ;; when using cocoa-emacs\r\n    (when *is-mac-gui*\r\n      ;; Woohoo!!\r\n      (global-set-key (kbd \"M-`\") 'ns-next-frame)\r\n      (global-set-key (kbd \"M-h\") 'ns-do-hide-emacs)\r\n      ;; what describe-key reports for cmd-option-h\r\n      (global-set-key (kbd \"M-ˍ\") 'ns-do-hide-others)\r\n      (after-load 'nxml-mode (define-key nxml-mode-map (kbd \"M-h\") nil)))\r\n\r\n# Key Bindings<a id=\"sec-12\" name=\"sec-12\"></a>\r\n\r\n## FIXME Global Mappings<a id=\"sec-12-1\" name=\"sec-12-1\"></a>\r\n\r\n    (global-set-key (kbd \"C-x C-m\") 'execute-extended-command)\r\n    (global-set-key (kbd \"C-c l\") 'org-store-link)\r\n    (global-set-key (kbd \"C-c a\") 'org-agenda)\r\n    (global-set-key (kbd \"C-c p\") 'duplicate-line-or-region)\r\n    (global-set-key (kbd \"C-f\") 'ace-jump-char-mode)\r\n    \r\n    (global-set-key (kbd \"<mouse-4>\") 'scroll-down-line)\r\n    (global-set-key (kbd \"<mouse-5>\") 'scroll-up-line)\r\n    \r\n    (global-set-key (kbd \"C-=\") 'er/expand-region)\r\n    (global-set-key (kbd \"C-x g\") 'magit-status)\r\n    (global-set-key (kbd \"C-c C-\\\\\") '(lambda() (interactive) (indent-region (point-min) (point-max))))\r\n    (global-set-key (kbd \"C-x v f\") 'vc-git-grep)\r\n    (global-set-key (kbd \"C-x v p\") #'git-messenger:popup-message)\r\n    (global-set-key (kbd \"C-c j\") '(lambda()(interactive)(join-line -1)))\r\n    (global-set-key (kbd \"M-x\") 'smex)\r\n    (global-set-key (kbd \"C-x o\") 'switch-window)\r\n    ; (global-set-key (kbd \"C-c c r\") 'set-rectangular-region-anchor)\r\n    ; (global-set-key (kbd \"C-c c c\") 'mc/edit-lines)\r\n    ; (global-set-key (kbd \"C-c c e\") 'mc/edit-ends-of-lines)\r\n    ; (global-set-key (kbd \"C-c c a\") 'mc/edit-beginnings-of-lines)\r\n    (global-set-key (kbd \"RET\") 'newline-and-indent)\r\n    (global-set-key (kbd \"<f7>\") 'preamble/split-window)\r\n    (global-set-key (kbd \"<f6>\") '(lambda() (interactive)(switch-to-buffer nil)))\r\n    (global-set-key (kbd \"C-x C-b\") 'ibuffer)\r\n    (global-set-key (kbd \"M-/\") 'hippie-expand)\r\n    (global-set-key (kbd \"C-x C-d\") 'preamble/ido-choose-from-recentf)\r\n    \r\n    (global-set-key (kbd \"C-.\") 'set-mark-command)\r\n    (global-set-key (kbd \"C-x C-.\") 'pop-global-mark)\r\n    \r\n    ;; multiple-cursors\r\n    (global-set-key (kbd \"C-<\") 'mc/mark-previous-like-this)\r\n    (global-set-key (kbd \"C->\") 'mc/mark-next-like-this)\r\n    (global-set-key (kbd \"C-+\") 'mc/mark-next-like-this)\r\n    (global-set-key (kbd \"C-c C-<\") 'mc/mark-all-like-this)\r\n    ; key (kbd \"M-Z\") 'zap-up-to-char)\r\n    (global-set-key (kbd \"C-M-=\") 'preamble/increase-default-font-height)\r\n    (global-set-key (kbd \"C-M--\") 'preamble/decrease-default-font-height)\r\n    \r\n    ;; stop C-z from minimizing windows under OS X\r\n    (global-set-key (kbd \"C-z\") '(lambda ()\r\n                                    (interactive) (unless *is-mac-gui*) (suspend-frame)))\r\n    \r\n    (when (and *is-mac* (fboundp 'toggle-frame-fullscreen))\r\n        ;; Command-Option-f to toggle fullscreen mode\r\n        ;; Hint: Customize `ns-use-native-fullscreen'\r\n        (global-set-key (kbd \"M-ƒ\") 'toggle-frame-fullscreen))\r\n    \r\n    (global-set-key (kbd \"M-C-8\") '(lambda () (interactive) (adjust-opacity nil -5)))\r\n    (global-set-key (kbd \"M-C-9\") '(lambda () (interactive) (adjust-opacity nil 5)))\r\n    (global-set-key (kbd \"M-C-0\") '(lambda () (interactive) (modify-frame-parameters nil `((alpha . 100)))))\r\n    \r\n    (global-set-key [remap query-replace-regexp] 'vr/query-replace)\r\n    (global-set-key [remap replace-regexp] 'vr/replace)\r\n    (after 'move-text (move-text-default-bindings))\r\n    (global-set-key [M-S-up] 'move-text-up)\r\n    (global-set-key [M-S-down] 'move-text-down)\r\n    (global-set-key [remap backward-up-list] 'backward-up-sexp) ; C-M-u, C-M-up\r\n    (global-set-key [remap open-line] 'sanityinc/open-line-with-reindent)\r\n    (global-set-key [remap query-replace-regexp] 'vr/query-replace)\r\n    (global-set-key [remap replace-regexp] 'vr/replace)\r\n    \r\n    (global-set-key (kbd \"C-M-<backspace>\") 'kill-back-to-indentation)\r\n\r\n# Updates<a id=\"sec-13\" name=\"sec-13\"></a>\r\n\r\nEmacs' Preamble is really smart! It can update itself, on the go.\r\n\r\n    (defun preamble/recompile-init ()\r\n      \"Byte-compile all your dotfiles again.\"\r\n      (interactive)\r\n      (byte-recompile-directory preamble-dir 0))\r\n    \r\n    (defun preamble/update ()\r\n      \"Update Preamble to its latest version.\"\r\n      (interactive)\r\n      (when (y-or-n-p \"Do you want to update Preamble? \")\r\n        (message \"Updating Preamble...\")\r\n        (cd preamble-dir)\r\n        (shell-command \"git pull\")\r\n        (preamble/recompile-init)\r\n        (message \"Update finished. Restart Emacs to complete the process.\")))\r\n\r\n## TODO there should be a scheduler to automatically check for updates.<a id=\"sec-13-1\" name=\"sec-13-1\"></a>\r\n\r\n# Epilogue<a id=\"sec-14\" name=\"sec-14\"></a>\r\n\r\nThings that need to be run at the end of the configuration have been specified here.\r\n\r\n    ; (require 'init-locales)\r\n    \r\n    (provide 'preamble)\r\n    ;;; preamble.el ends here","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}